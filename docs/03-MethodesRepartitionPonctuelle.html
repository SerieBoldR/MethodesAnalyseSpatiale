<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Méthodes d’analyse spatiale : un grand bol d’R - 3&nbsp; Méthodes de répartition ponctuelle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-AgregatsSpatiaux.html" rel="next">
<link href="./02-Autocorrelation.html" rel="prev">
<link href="./images/introduction/Couverture_16_01-01.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="css/quizlib.min.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-MethodesRepartitionPonctuelle.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Méthodes de répartition ponctuelle</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Méthodes d’analyse spatiale : un grand bol d’R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SerieBoldR/MethodesAnalyseSpatiale" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-auteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">À propos des auteurs</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 1. Données spatiales et R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-ManipulationDonneesSpatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Manipulation des données spatiales dans&nbsp;R</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 2. Autocorrélation spatiale</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Autocorrelation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Autocorrélation spatiale</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 3. Méthodes de répartition ponctuelle et de détections d’agrégats spatiaux</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-MethodesRepartitionPonctuelle.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Méthodes de répartition ponctuelle</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-AgregatsSpatiaux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Méthodes de détection d’agrégats spatiaux et spatio-temporels</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 4. Analyses de données avec des réseaux de transport</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-AnalyseReseau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mesures d’accessibilité spatiale selon différents modes de transport</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-AnalyseReseauEvenements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analyses d’évènements localisés sur un réseau</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 5. Régressions spatiales et classifications spatiales</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-RegressionSpatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction aux modèles de régression spatiale</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-ClassificationsSpatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Méthodes de classification non supervisée spatiale</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Partie 6. Exercices et bibliographie</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Exercices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correction des exercices</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li><a href="#sec-031" id="toc-sec-031" class="nav-link active" data-scroll-target="#sec-031"><span class="header-section-number">3.1</span> Fréquence et densité des points dans l’espace d’étude</a></li>
  <li>
<a href="#sec-032" id="toc-sec-032" class="nav-link" data-scroll-target="#sec-032"><span class="header-section-number">3.2</span> Analyse centrographique</a>
  <ul class="collapse">
<li><a href="#sec-0311" id="toc-sec-0311" class="nav-link" data-scroll-target="#sec-0311"><span class="header-section-number">3.2.1</span> Paramètres de tendance centrale d’un semis de points</a></li>
  <li><a href="#sec-0312" id="toc-sec-0312" class="nav-link" data-scroll-target="#sec-0312"><span class="header-section-number">3.2.2</span> Paramètres de dispersion d’un semis de points</a></li>
  <li><a href="#sec-0313" id="toc-sec-0313" class="nav-link" data-scroll-target="#sec-0313"><span class="header-section-number">3.2.3</span> Mise en œuvre de l’analyse centrographique dans&nbsp;R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-033" id="toc-sec-033" class="nav-link" data-scroll-target="#sec-033"><span class="header-section-number">3.3</span> Forme d’un semis de points</a>
  <ul class="collapse">
<li><a href="#sec-0331" id="toc-sec-0331" class="nav-link" data-scroll-target="#sec-0331"><span class="header-section-number">3.3.1</span> Méthode du plus proche voisin</a></li>
  <li><a href="#sec-0332" id="toc-sec-0332" class="nav-link" data-scroll-target="#sec-0332"><span class="header-section-number">3.3.2</span> Méthode des quadrats</a></li>
  </ul>
</li>
  <li>
<a href="#sec-034" id="toc-sec-034" class="nav-link" data-scroll-target="#sec-034"><span class="header-section-number">3.4</span> Cartographie de la densité des points</a>
  <ul class="collapse">
<li><a href="#sec-0341" id="toc-sec-0341" class="nav-link" data-scroll-target="#sec-0341"><span class="header-section-number">3.4.1</span> Cartographie de la densité dans une maille irrégulière</a></li>
  <li><a href="#sec-0342" id="toc-sec-0342" class="nav-link" data-scroll-target="#sec-0342"><span class="header-section-number">3.4.2</span> Cartographie de la densité dans une maille régulière</a></li>
  <li><a href="#sec-0343" id="toc-sec-0343" class="nav-link" data-scroll-target="#sec-0343"><span class="header-section-number">3.4.3</span> Densité spatio-temporelle dans une maille régulière</a></li>
  </ul>
</li>
  <li><a href="#sec-035" id="toc-sec-035" class="nav-link" data-scroll-target="#sec-035"><span class="header-section-number">3.5</span> Quiz de révision du chapitre</a></li>
  <li><a href="#sec-036" id="toc-sec-036" class="nav-link" data-scroll-target="#sec-036"><span class="header-section-number">3.6</span> Exercices de révision</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/SerieBoldR/MethodesAnalyseSpatiale/issues/new" class="toc-action">Signaler un problème ou<br>formuler une suggestion</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-chap03" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Méthodes de répartition ponctuelle</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Dans ce chapitre, nous abordons les méthodes de répartition ponctuelle qui permettent de décrire un semis de points dans un espace géographique donné. En géomatique appliquée, ces méthodes sont fréquemment employées dans le cadre d’études rattachées à des champs disciplinaires variés comme&nbsp;:</p>
<ul>
<li>En études urbaines, pour décrire la répartition de services et d’équipements collectifs à travers une ville afin de vérifier s’ils sont équitablement répartis ou à l’inverse, concentrés dans certaines parties de la ville.</li>
<li>En biologie, pour décrire la répartition d’espèces fauniques ou végétales dans un territoire.</li>
<li>En criminologie, pour analyser la répartition spatiale d’un ou de plusieurs types de crimes.</li>
<li>En épidémiologie, pour comprendre l’évolution de la répartition spatiale des cas d’une maladie infectieuse.</li>
<li>En transport, pour analyser la répartition d’accidents.</li>
<li>Et même en sciences de l’activité physique, pour analyser la distribution spatiale de personnes pratiquant un sport sur un terrain de soccer, de rugby, de tennis, de baseball, etc.</li>
</ul>
<div class="bloc_package">
<div class="bloc_package-header">
<div class="bloc_package-icon">

</div>
<p><strong>Liste des <em>packages</em> utilisés dans ce chapitre</strong></p>
</div>
<div class="bloc_package-body">
<ul>
<li>Pour importer et manipuler des fichiers géographiques&nbsp;:
<ul>
<li>
<code>sf</code> pour importer et manipuler des données vectorielles.</li>
</ul>
</li>
<li>Pour construire des cartes et des graphiques&nbsp;:
<ul>
<li>
<code>tmap</code> pour construire des cartes thématiques.</li>
<li>
<code>ggplot2</code> est un <em>package</em> pour construire des graphiques.</li>
</ul>
</li>
<li>Pour les analyses de méthodes de répartition ponctuelle&nbsp;:
<ul>
<li>
<code>spatstat</code> est sans aucun doute le meilleur <em>package</em>.</li>
<li>
<code>sparr</code> pour calculer la STKDE, soit l’estimation de la densité par noyau spatio-temporel (<em>Space-Time Kernel density Estimatation</em>).</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="bloc_objectif">
<div class="bloc_objectif-header">
<div class="bloc_objectif-icon">

</div>
<p><strong>Pour décrire la distribution d’un semis de points, nous voyons les méthodes suivantes&nbsp;:</strong></p>
</div>
<div class="bloc_objectif-body">
<ul>
<li>La fréquence et la densité des points dans l’espace d’étude.</li>
<li>L’analyse centrographique&nbsp;:
<ul>
<li>Paramètres de tendance centrale (centre moyen et point central).</li>
<li>Dispersion du semis de points (distance standard) et ses différentes représentations graphiques (cercle et ellipse de distance standard).</li>
</ul>
</li>
<li>L’arrangement spatial du semis de points&nbsp;:
<ul>
<li>Méthode du plus proche voisin.</li>
<li>Méthode des quadrats.</li>
</ul>
</li>
<li>La cartographie de la densité&nbsp;:
<ul>
<li>Dans une maille irrégulière (des polygones de forme et de taille différentes).</li>
<li>Dans une maille régulière (estimation de la densité par noyau – <em>kernel density estimation, KDE</em>).</li>
</ul>
</li>
</ul>
</div>
</div>
<section id="sec-031" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="sec-031">
<span class="header-section-number">3.1</span> Fréquence et densité des points dans l’espace d’étude</h2>
<p>La <strong>fréquence</strong> est tout simplement le nombre de points présents dans une région donnée (par exemple, le nombre d’hôpitaux, de stations de métro, d’arbres, etc.). La <strong>densité</strong> est le ratio entre la fréquence et la <em>superficie totale</em> de la région donnée ou la <em>population</em>.</p>
<p>Par exemple, le <a href="#tbl-TableauMetros">tableau&nbsp;<span>3.1</span></a> renvoie le nombre et la densité des stations de métro (pour 10&nbsp;000&nbsp;habitants) pour trois villes. Interprétez ces chiffres avec prudence, car ils varient en fonction de la taille du territoire retenu pour les trois villes.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-TableauMetros" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;3.1: Fréquence et densité des stations de métro dans trois villes</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 43%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Ville</th>
<th style="text-align: left;">Population</th>
<th style="text-align: right;">Stations de métro</th>
<th style="text-align: center;">Densité (stations / 10 000 hab.)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">New York</td>
<td style="text-align: left;">8 804 000</td>
<td style="text-align: right;">424</td>
<td style="text-align: center;">0,5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paris</td>
<td style="text-align: left;">2 165 000</td>
<td style="text-align: right;">309</td>
<td style="text-align: center;">1,4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Île de Montréal</td>
<td style="text-align: left;">2 004 000</td>
<td style="text-align: right;">68</td>
<td style="text-align: center;">0,3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="sec-032" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sec-032">
<span class="header-section-number">3.2</span> Analyse centrographique</h2>
<p>L’analyse centrographique est une approche qui a été largement utilisée durant les décennies 1990 et 2000. Son utilisation est parfois critiquée pour deux raisons principales&nbsp;: 1)&nbsp;elle ne décrit que partiellement le semis de points; 2)&nbsp;aucun test d’inférence n’est calculé. Quoi qu’il en soit, elle permet d’explorer les données avant de se lancer dans des analyses plus avancées.</p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Utilisation de l’analyse centrographique au Québec et dans le monde francophone</strong></p>
</div>
<div class="bloc_notes-body">
<p>Marius Thériault (géographe et professeur émérite à l’Université Laval) a largement contribué à la popularité de l’analyse centrographique au Québec et ailleurs. Il est le créateur de <em>MapStat</em>, un module développé avec le langage MapBasic intégré dans le logiciel SIG MapInfo permettant de réaliser une analyse centrographique avant même qu’elle soit implémentée dans ArcGIS. En guise d’exemple, les études suivantes utilisent l’analyse centrographique calculée avec <em>MapStat</em> <span class="citation" data-cites="lopez2015evolution barbonne2007dynamique">(<a href="references.html#ref-lopez2015evolution" role="doc-biblioref">López Castro, Thériault et Vandersmissen 2015</a>; <a href="references.html#ref-barbonne2007dynamique" role="doc-biblioref">Barbonne, Villeneuve et Thériault 2007</a>)</span>. Consultez-les au besoin.</p>
</div>
</div>
<section id="sec-0311" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-0311">
<span class="header-section-number">3.2.1</span> Paramètres de tendance centrale d’un semis de points</h3>
<p>Les deux principaux paramètres de tendance centrale d’un semis de points sont le centre moyen et le point central qui peuvent être on non pondérés.</p>
<section id="sec-03111" class="level4" data-number="3.2.1.1"><h4 data-number="3.2.1.1" class="anchored" data-anchor-id="sec-03111">
<span class="header-section-number">3.2.1.1</span> Centre moyen</h4>
<p>Le centre moyen (<span class="math inline">\(cm\)</span>) est le centre de gravité du semis de points et correspond aux valeurs des moyennes arithmétiques des coordonnées géographiques (<a href="#eq-CentreMoyen">équation&nbsp;<span>3.1</span></a>).</p>
<p><span id="eq-CentreMoyen"><span class="math display">\[
(\bar{x}_{cm}, \bar{y}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}\Biggl)\text{ avec :}
\tag{3.1}\]</span></span></p>
<ul>
<li>
<span class="math inline">\((\bar{x}_{cm}, \bar{y}_{cm})\)</span>, les coordonnées géographiques du point moyen.</li>
<li>
<span class="math inline">\(n\)</span>, le nombre de points dans la couche géographique.</li>
<li>
<span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span>, les coordonnées géographiques du point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Il est possible de calculer le centre moyen en pondérant chacun des points du semis avec la valeur d’une variable donnée (<a href="#eq-CentreMoyenPonderee">équation&nbsp;<span>3.2</span></a>). Ainsi, l’importance accordée à chacun des points n’est pas la même. Par exemple, nous pourrions calculer le centre moyen pondéré (<span class="math inline">\(cmp\)</span>) des cliniques médicales d’une ville en pondérant chaque clinique par le nombre de médecins, ou encore le point moyen des hôpitaux pondéré par le nombre de lits. Autre exemple, avec un jeu de données sur les arbres dans une érablière, nous pourrions utiliser une pondération basée sur le diamètre à la hauteur de la poitrine (DHP) afin d’accorder un poids plus important aux arbres de plus «&nbsp;grand volume&nbsp;».</p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Moyenne pondérée</strong></p>
</div>
<div class="bloc_notes-body">
<p><strong>Pour un rappel sur le calcul d’une moyenne pondérée</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect027.html"><em>Statistiques descriptives pondérées</em></a> <span class="citation" data-cites="RBoldAir">(<a href="references.html#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
</div>
<p><span id="eq-CentreMoyenPonderee"><span class="math display">\[
(\bar{x}_{cmp}, \bar{y}_{cmp}) = \Biggl( \frac{\Sigma_{i=1}^n w_ix_i}{\Sigma_{i=1}^nw_i}, \frac{\Sigma_{i=1}^n w_iy_i}{\Sigma_{i=1}^nw_i}\Biggl) \text{ avec :}
\tag{3.2}\]</span></span></p>
<ul>
<li>
<span class="math inline">\(n\)</span>, <span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span> étant définis plus haut.</li>
<li>
<span class="math inline">\((\bar{x}_w, \bar{y}_w)\)</span>, les coordonnées géographiques du point moyen pondéré.</li>
<li>
<span class="math inline">\(w_i\)</span>, la valeur de pondération associée au point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Le centre moyen et le centre moyen pondéré sont des mesures très utiles pour comparer la distribution de plusieurs semis de points (de différents services et équipements collectifs par exemple) ou encore pour décrire l’évolution dans le temps de la répartition d’un semis de points. L’analyse du déplacement du centre moyen (pondéré) à différentes dates nous informe ainsi de l’évolution du phénomène à l’étude et plus spécifiquement, de son orientation et de sa direction.</p>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Exemple d’utilisation temporelle du centre moyen pondéré</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Un exemple classique d’utilisation du centre moyen pondéré sur plusieurs années est l’évolution du centre moyen pondéré de la population des États-Unis de 1790 à 2020. Il est calculé à partir des centroïdes des comtés américains et de la population comme variable de pondération extraite des recensements de l’<em>US Census Bureau</em>. Bien entendu, le centre moyen pondéré se déplace vers l’ouest.</p>
<p>Vous pouvez consulter <a href="https://www.census.gov/library/visualizations/2020/geo/center-of-population-1790-2020.html">cette carte</a> ou visionner cette <a href="https://www.youtube.com/watch?v=D9XelnGyggI">courte vidéo YouTube ludique</a>.</p>
</div>
</div>
<p>Notez que les centres moyen et moyen pondéré peuvent aussi être calculés sur des données géographiques comprenant des valeurs d’élévation (<span class="math inline">\(x,y,z\)</span>)&nbsp;:</p>
<p><span id="eq-PointMoyenZ1"><span class="math display">\[
(\bar{x}_{cm}, \bar{y}_{cm}, \bar{z}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}, \frac{w_i\Sigma_{i=1}^n z_i}{n}\Biggl)
\tag{3.3}\]</span></span></p>
<p><span id="eq-PointMoyenZ2"><span class="math display">\[
(\bar{x}_{cmp}, \bar{y}_{cmp}, \bar{z}_{cmp}) = \Biggl( \frac{w_i\Sigma_{i=1}^n x_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n y_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n z_i}{\Sigma_{i=1}^nw_i}\Biggl)
\tag{3.4}\]</span></span></p>
</section><section id="sec-03112" class="level4" data-number="3.2.1.2"><h4 data-number="3.2.1.2" class="anchored" data-anchor-id="sec-03112">
<span class="header-section-number">3.2.1.2</span> Point central</h4>
<p>Le point central d’un semis de points est celui qui minimise la somme des distances le séparant de tous les autres points (<a href="#eq-PointCentral">équation&nbsp;<span>3.5</span></a>). Tout comme le point moyen, il est aussi possible de calculer le point central pondéré (<a href="#eq-PointCentralW">équation&nbsp;<span>3.6</span></a>).</p>
<p><span id="eq-PointCentral"><span class="math display">\[
pc=\text{Min}\Biggl(\Sigma_{i=1}^n \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.5}\]</span></span></p>
<p><span id="eq-PointCentralW"><span class="math display">\[
pcp=\text{Min}\Biggl(\Sigma_{i=1}^n w_i \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.6}\]</span></span></p>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Différence entre point central et centre moyen</strong></p>
</div>
<div class="bloc_attention-body">
<p>Contrairement au centre moyen, le point central fait partie du semis de points initial.</p>
<p><strong>Utilité du point central pondéré</strong></p>
<p>Imaginez que des personnes étudiantes en géographie et en géomatique de toutes les universités du Québec souhaitent organiser une rencontre en présence. Calculer le point central, pondéré par le nombre de personnes étudiantes par établissement participant à la rencontre, permet d’identifier l’université la plus centrale. Idéalement, il faudrait obtenir ce point central pondéré avec les distances temps calculées avec un réseau routier.</p>
</div>
</div>
</section></section><section id="sec-0312" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-0312">
<span class="header-section-number">3.2.2</span> Paramètres de dispersion d’un semis de points</h3>
<p>Les deux principaux paramètres de dispersion d’un semis de points sont la distance standard et la distance standard pondérée. La dispersion d’un semis de points peut être représentée graphiquement avec une enveloppe convexe, un cercle de rayon de standard ou une ellipse (avec ou sans pondération).</p>
<section id="sec-03121" class="level4" data-number="3.2.2.1"><h4 data-number="3.2.2.1" class="anchored" data-anchor-id="sec-03121">
<span class="header-section-number">3.2.2.1</span> Distance standard et distance standard pondérée</h4>
<p>En statistique univariée, l’écart-type (<a href="#eq-ecartype">équation&nbsp;<span>3.7</span></a>) est une mesure de dispersion bien connue&nbsp;: plus la valeur de l’écart-type est élevée, plus la dispersion des valeurs de la variable autour de la moyenne (<span class="math inline">\(\mu\)</span>) est importante.</p>
<p><span id="eq-ecartype"><span class="math display">\[
\sigma=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n}}
\tag{3.7}\]</span></span></p>
<div class="bloc_notes">
<div class="bloc_notes-header">
<div class="bloc_notes-icon">

</div>
<p><strong>Écart-type</strong></p>
</div>
<div class="bloc_notes-body">
<p><strong>Pour un rappel sur l’écart-type</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253"><em>Paramètres de dispersion</em></a> <span class="citation" data-cites="RBoldAir">(<a href="references.html#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
</div>
<p><strong>Distance standard (pondérée ou non) des <em>X</em> et des <em>Y</em></strong></p>
<p>De manière analogue à l’écart-type, nous pouvons calculer la distance standard pour les coordonnées <em>X</em> et pour les coordonnées <em>Y</em> des points, soit l’écart moyen respectif au centre moyen (<a href="#eq-distancestandardxy">équation&nbsp;<span>3.8</span></a>) ou au centre moyen pondéré (<a href="#eq-distancestandardxyw">équation&nbsp;<span>3.9</span></a>).</p>
<p><span id="eq-distancestandardxy"><span class="math display">\[
\sigma_x=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n}} \text{ et }
\sigma_y=\sqrt{\frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.8}\]</span></span></p>
<p><span id="eq-distancestandardxyw"><span class="math display">\[
\sigma_{xw}=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n{w_i}}} \text{ et } \sigma_{yw}=\sqrt{\frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n{w_i}}}
\tag{3.9}\]</span></span></p>
<p><strong>Distance standard (pondérée ou non)</strong></p>
<p>Nous pouvons aussi calculer la distance standard (<span class="math inline">\(ds\)</span>) sans pondération (<a href="#eq-distancestandard">équation&nbsp;<span>3.10</span></a>) et avec pondération (<a href="#eq-distancestandardw">équation&nbsp;<span>3.11</span></a>). Plus elle est forte, plus les points sont dispersés autour du centre moyen ou du centre moyen pondéré. Inversement, une faible distance standard indique une concentration de points autour du centre moyen.</p>
<p><span id="eq-distancestandard"><span class="math display">\[
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.10}\]</span></span></p>
<p><span id="eq-distancestandardw"><span class="math display">\[
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.11}\]</span></span></p>
<p>De nouveau, ces mesures peuvent être adaptées pour des points avec une élévation (<span class="math inline">\(x,y,z\)</span>)&nbsp;:</p>
<p><span id="eq-distancestandardz"><span class="math display">\[
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n} + \frac{\sum_{i=1}^n (z_{i}-\bar{z}_{cm})^2}{n}}
\tag{3.12}\]</span></span></p>
<p><span id="eq-distancestandardwz"><span class="math display">\[
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(z_{i}-\bar{z}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.13}\]</span></span></p>
</section><section id="sec-03122" class="level4" data-number="3.2.2.2"><h4 data-number="3.2.2.2" class="anchored" data-anchor-id="sec-03122">
<span class="header-section-number">3.2.2.2</span> Représenter la dispersion&nbsp;: cercle de distance standard et ellipse</h4>
<p>La dispersion d’un semis de points peut être représentée de quatre manières différentes&nbsp;:</p>
<ol type="1">
<li><p>Une enveloppe convexe des points décrite à la <a href="01-ManipulationDonneesSpatiales.html#sec-01225">section&nbsp;<span>1.2.2.5</span></a>).</p></li>
<li><p>Un rectangle centré sur le centre moyen avec les déviations des coordonnées <em>X</em> et <em>Y</em> pondérées ou non (<a href="#eq-distancestandardxy">équation&nbsp;<span>3.8</span></a> et <a href="#eq-distancestandardxyw">équation&nbsp;<span>3.9</span></a> décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est un parallélépipède rectangle.</p></li>
<li><p>Un cercle de rayon de distance standard pondérée ou non (<a href="#eq-distancestandard">équation&nbsp;<span>3.10</span></a> et <a href="#eq-distancestandardw">équation&nbsp;<span>3.11</span></a>) décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est une sphère de rayon de distance standard.</p></li>
<li><p>Une ellipse de distance standard pondérée ou non. Dans le cas de données comprenant l’élévation, la forme géométrique est un ellipsoïde.</p></li>
</ol>
<p><strong>Prenons un jeu de données fictives</strong> pour décrire ces quatre représentations graphiques. Imaginons que nous avons observé le parc de la Laurentie à Sherbrooke pour comprendre son utilisation. Pour collecter des données sur la localisation des personnes utilisatrices, nous aurions pu utiliser un questionnaire dans QField ou ArcGIS&nbsp;Survey&nbsp;123. La <a href="#fig-PointsB">figure&nbsp;<span>3.1</span></a> illustre la localisation de dix personnes (points rouges).</p>
<div id="fig-PointsB" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/CartePointsB.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke</figcaption></figure>
</div>
<p>À partir de ces dix points, nous obtenons&nbsp;:</p>
<ul>
<li><p>Les coordonnées du <strong>centre moyen</strong> qui sont égales à -8&nbsp;007&nbsp;869 et 5&nbsp;685&nbsp;921, soit simplement les moyennes des coordonnées <em>X</em> et <em>Y</em> des dix observations.</p></li>
<li><p>L’<strong>enveloppe convexe des points</strong> qui contient tous les points.</p></li>
<li><p><strong>Le rectangle construit avec les déviations standards des <em>X</em> et des <em>Y</em></strong> qui est centré sur le centre moyen. À partir de ce point, nous ajoutons à l’est et à l’ouest la valeur de la distance standard des <em>X</em> et au nord et au sud celle des <em>Y</em>. Les valeurs de ces distances standards sont égales à&nbsp;32,60 et 52,20&nbsp;mètres (voir les calculs au <a href="#tbl-DonneesFictivesCasB">tableau&nbsp;<span>3.2</span></a>).</p></li>
<li><p>La <strong>distance standard</strong> est égale à 61,59&nbsp;mètres (voir les calculs au <a href="#tbl-DonneesFictivesCasB">tableau&nbsp;<span>3.2</span></a>). À partir de cette distance, nous traçons le cercle ayant comme rayon la distance standard.</p></li>
<li><p>L’<strong>ellipse de déviation de distance standard</strong> (<a href="#fig-ExplicationEllipse">figure&nbsp;<span>3.2</span></a>).</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-DonneesFictivesCasB" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;3.2: Calcul des distances standards des X et des Y et de la distance standard</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 38%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">Point</th>
<th style="text-align: right;"><span class="math inline">\(x_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\(y_i\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x_{i}-\bar{x}_{cm})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span></th>
<th style="text-align: right;">
<span class="math inline">\((x_{i}-\bar{x}_{cm})^2+\)</span><span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-8007877</td>
<td style="text-align: right;">5686000</td>
<td style="text-align: right;">52,80</td>
<td style="text-align: right;">6347,70</td>
<td style="text-align: right;">6400,50</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-8007843</td>
<td style="text-align: right;">5685993</td>
<td style="text-align: right;">716,90</td>
<td style="text-align: right;">5298,00</td>
<td style="text-align: right;">6014,90</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-8007836</td>
<td style="text-align: right;">5685976</td>
<td style="text-align: right;">1082,00</td>
<td style="text-align: right;">3046,30</td>
<td style="text-align: right;">4128,30</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-8007859</td>
<td style="text-align: right;">5685928</td>
<td style="text-align: right;">98,90</td>
<td style="text-align: right;">60,30</td>
<td style="text-align: right;">159,20</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-8007911</td>
<td style="text-align: right;">5685935</td>
<td style="text-align: right;">1770,20</td>
<td style="text-align: right;">214,60</td>
<td style="text-align: right;">1984,80</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-8007913</td>
<td style="text-align: right;">5685871</td>
<td style="text-align: right;">1934,80</td>
<td style="text-align: right;">2461,00</td>
<td style="text-align: right;">4395,80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-8007888</td>
<td style="text-align: right;">5685855</td>
<td style="text-align: right;">365,70</td>
<td style="text-align: right;">4363,40</td>
<td style="text-align: right;">4729,10</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">-8007835</td>
<td style="text-align: right;">5685857</td>
<td style="text-align: right;">1185,00</td>
<td style="text-align: right;">4016,80</td>
<td style="text-align: right;">5201,80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">-8007824</td>
<td style="text-align: right;">5685886</td>
<td style="text-align: right;">2071,70</td>
<td style="text-align: right;">1203,50</td>
<td style="text-align: right;">3275,20</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">-8007906</td>
<td style="text-align: right;">5685904</td>
<td style="text-align: right;">1376,50</td>
<td style="text-align: right;">266,70</td>
<td style="text-align: right;">1643,30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">n</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">Somme</td>
<td style="text-align: right;">-80078693</td>
<td style="text-align: right;">56859207</td>
<td style="text-align: right;">10654,50</td>
<td style="text-align: right;">27278,30</td>
<td style="text-align: right;">37932,80</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Moyenne</td>
<td style="text-align: right;">-8007869</td>
<td style="text-align: right;">5685921</td>
<td style="text-align: right;">1065,45</td>
<td style="text-align: right;">2727,83</td>
<td style="text-align: right;">3793,28</td>
</tr>
<tr class="even">
<td style="text-align: right;">Racine carrée</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">32,60</td>
<td style="text-align: right;">52,20</td>
<td style="text-align: right;">61,59</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="fig-ExplicationEllipse" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/ExplicationEllipse.png" class="img-fluid figure-img" style="width:35.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.2: Trois éléments composant une ellipse</figcaption></figure>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Calcul des ellipses&nbsp;: des résultats qui varient d’un logiciel à l’autre…</strong></p>
</div>
<div class="bloc_attention-body">
<p>Il existe plusieurs solutions pour tracer une ellipse. Pour une discussion détaillée de ces différentes solutions, lisez le <a href="https://portailsig.org/content/qgis-des-ellipses-de-deviation-standard-sde-un-plugin-standard-deviational-ellipse-des-scrip.html">court texte très intéressant de Martin Leroux</a>.</p>
<ul>
<li><p>Ellipse de Yuill <span class="citation" data-cites="tveitesde">(<a href="references.html#ref-tveitesde" role="doc-biblioref">Tveite 2020</a>)</span>.</p></li>
<li><p>Ellipse basée sur la covariance implémentée dans <a href="https://pro.arcgis.com/en/pro-app/3.0/tool-reference/spatial-statistics/h-how-directional-distribution-standard-deviationa.htm">ArcGIS&nbsp;Pro</a>.</p></li>
<li><p>Ellipse de distance standard implémentée dans le logiciel&nbsp;<a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a>.</p></li>
<li><p>Ellipse avec la correction proposée par Wang et ses collègues <span class="citation" data-cites="wang2015confidence">(<a href="references.html#ref-wang2015confidence" role="doc-biblioref">2015</a>)</span>.</p></li>
</ul>
<p>Notez qu’un plugin QGIS nommé <em>The QGIS Standard Deviational Ellipse Plugin</em> <span class="citation" data-cites="tveitesde">(<a href="references.html#ref-tveitesde" role="doc-biblioref">Tveite 2020</a>)</span> intègre plusieurs de ces méthodes. Les résultats varient ainsi d’un logiciel à l’autre selon la méthode implémentée. Autrement dit, pour un même jeu de données ponctuelles, les ellipses obtenues avec ArcGIS&nbsp;Pro, ArcMap&nbsp;9.3, ArcMap&nbsp;10.x et QGIS seront différentes.</p>
<p><strong>Quoi faire alors?</strong></p>
<p>Quelle que soit la méthode utilisée, l’ellipse est toujours centrée sur le point moyen et a toujours le même angle de rotation. Par contre, la taille de l’ellipse (superficie) varie. Par conséquent, si vous souhaitez comparer des ellipses différentes, assurez-vous toujours qu’elles sont toutes obtenues dans le même logiciel et avec la même solution.</p>
</div>
</div>
<div class="bloc_aller_loin">
<div class="bloc_aller_loin-header">
<div class="bloc_aller_loin-icon">

</div>
<p><strong>Calcul de l’ellipse selon la méthode implémentée dans CrimeStat</strong></p>
</div>
<div class="bloc_aller_loin-body">
<p>Ned Levine <span class="citation" data-cites="levine2006crime levine2021crimestat">(<a href="references.html#ref-levine2006crime" role="doc-biblioref">2006</a>; <a href="references.html#ref-levine2021crimestat" role="doc-biblioref">2021</a>)</span>, créateur du logiciel&nbsp;<a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a>, propose les formulations suivantes pour le calcul d’une ellipse&nbsp;:</p>
<p><span id="eq-CrimeStatRotation"><span class="math display">\[
\theta = \frac{\text{arctan} \Biggl\{ \Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)+  \Bigr[\Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)^2 + 4 \Bigl(\sum_{i=1}^nx_dy_d \Bigl)^2\Bigr]^{1/2} \Biggl\}} {2 \sum_{i=1}^nx_dy_d}
\tag{3.14}\]</span></span></p>
<p>avec <span class="math inline">\(\theta\)</span> est la rotation de l’ellipse, <span class="math inline">\(x_d = x_i-\bar{x}\)</span> et <span class="math inline">\(y_d = y_i-\bar{y}\)</span>.</p>
<p><span id="eq-CrimeStatSigmaX"><span class="math display">\[
\sigma_x =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{cos}\theta-(y_i-\bar{y})\text{sin}\theta\Bigl)^2}{n-2}}
\tag{3.15}\]</span></span></p>
<p><span id="eq-CrimeStatSigmaY"><span class="math display">\[
\sigma_y =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{sin}\theta-(y_i-\bar{y})\text{cos}\theta\Bigl)^2}{n-2}}
\tag{3.16}\]</span></span></p>
<p><span id="eq-CrimeStatSuperficieLyLx"><span class="math display">\[
l_x=2\sigma_x \text{ et }l_y=2\sigma_y \text{ et }S_e=\pi\sigma_x\sigma_y
\tag{3.17}\]</span></span></p>
<p>avec <span class="math inline">\(l_x\)</span>, <span class="math inline">\(l_y\)</span> et <span class="math inline">\(S_e\)</span> étant les longueurs de axes <em>X</em> et <em>Y</em> et la superficie de l’ellipse.</p>
</div>
</div>
<p>Prenons quatre situations fictives de répartition de dix personnes utilisatrices du parc de la Laurentie à Sherbrooke&nbsp;:</p>
<ul>
<li>
<strong>Situation A</strong>. Les observations sont concentrées autour de l’aire de jeu.</li>
<li>
<strong>Situation B</strong>. Les observations sont dispersées dans la partie est du parc.</li>
<li>
<strong>Situation C</strong>. Les observations sont concentrées dans la partie nord du parc.</li>
<li>
<strong>Situation D</strong>. Les observations sont concentrées dans la partie nord du parc, excepté deux observations au sud.</li>
</ul>
<div id="fig-PointsABCD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/CartePointsABCD.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.3: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke (quatre situations)</figcaption></figure>
</div>
<p>Les cercles et les ellipses de distance standard (<span class="math inline">\(ds\)</span>) centrés au centre moyen (<span class="math inline">\(cm\)</span>) sont représentés à la (<a href="#fig-EllipsesCercleABCD">figure&nbsp;<span>3.4</span></a>).</p>
<div id="fig-EllipsesCercleABCD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/CartePointsABCD_DS.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.4: Ellipse et cercle de distance standard pour les quatre situations</figcaption></figure>
</div>
</section><section id="sec-03123" class="level4" data-number="3.2.2.3"><h4 data-number="3.2.2.3" class="anchored" data-anchor-id="sec-03123">
<span class="header-section-number">3.2.2.3</span> Comparaison de la dispersion de deux semis de points dans deux régions différentes</h4>
<p>Pour comparer la dispersion de deux semis de points situés dans des régions de taille différente, il convient de supprimer les effets de taille des deux régions. Pour ce faire, nous divisons la <strong>distance standard</strong> ou la <strong>distance standard pondérée</strong> par la superficie de la région. Cette approche est donc très similaire au <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253">coefficient de variation</a> en statistique univariée, soit le rapport entre l’écart-type et la moyenne.</p>
<p>Par exemple, si nous comparons les dispersions des personnes utilisatrices du parc de la Laurentie (0,078&nbsp;ha) et parc du Mont-Bellevue (409&nbsp;ha). Inévitablement, la valeur de la distance standard est plus forte pour le parc du Mont-Bellevue que celle du parc de la Laurentie. Il faut donc diviser chaque distance standard par la superficie associée.</p>
</section><section id="sec-03124" class="level4" data-number="3.2.2.4"><h4 data-number="3.2.2.4" class="anchored" data-anchor-id="sec-03124">
<span class="header-section-number">3.2.2.4</span> Comparaison de la dispersion de deux semis de points dans la même région</h4>
<p>Pour comparer la distribution spatiale de deux semis de points situés dans la même région, nous comparons leur cercle ou leur ellipse respective (par exemple, des points représentant des accidents l’été versus l’hiver ou encore deux espèces végétales sur le même territoire).</p>
<p>Une démarche similaire peut être appliquée à deux groupes de population rattachés à des entités polygonales&nbsp;: ils ont la même distribution spatiale si les deux ellipses de distance pondérée se juxtaposent significativement. David W.S. Wong <span class="citation" data-cites="wong1999geostatistics">(<a href="references.html#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span> propose d’ailleurs un indice dénommé <em>S</em> basé sur la comparaison des deux ellipses (<a href="#eq-WongIndice2Groupes">équation&nbsp;<span>3.18</span></a>). Le numérateur représente la surface d’intersection entre les deux ellipses tandis que le dénominateur représente leur surface d’union. L’indice varie de 0 à 1, soit respectivement d’une similitude parfaite à une dissemblance la plus grande entre les deux distributions spatiales&nbsp;:</p>
<ul>
<li><p>Si deux groupes de population ont des distributions spatiales identiques, les ellipses sont les mêmes et donc <span class="math inline">\(E_i \cap E_j = E_i \cup E_j = 1\)</span> et <span class="math inline">\(S_{ij} = 1 - 1 = 0\)</span>.</p></li>
<li><p>Si les deux groupes de population ont des distributions spatiales totalement différentes, les ellipses ne se touchent pas, alors <span class="math inline">\(E_i \cap E_j = 0\)</span> et la valeur de <span class="math inline">\(S = 1 - 0 = 1\)</span>.</p></li>
</ul>
<p>Bien évidemment, cet indice peut être étendu pour comparer les distributions de plus de deux groupes de population simultanément (<a href="#eq-WongIndiceNGroupes">équation&nbsp;<span>3.19</span></a>).</p>
<p><span id="eq-WongIndice2Groupes"><span class="math display">\[
S_{ij}=1-\frac{E_i \cap E_j}{E_i \cup E_j}
\tag{3.18}\]</span></span></p>
<p><span id="eq-WongIndiceNGroupes"><span class="math display">\[
S=1-\frac{E_1 \cap E_2 \cap E_3 \cap \text{…} \cap E_n}{E_1 \cup E_2 \cup E_3 \cup \text{…} \cup E_n}
\tag{3.19}\]</span></span></p>
<p><strong>Voyons un exemple concret</strong>&nbsp;: calculons l’indice de Wong <span class="citation" data-cites="wong1999geostatistics">(<a href="references.html#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span> (<a href="#eq-WongIndice2Groupes">équation&nbsp;<span>3.18</span></a>) pour les ellipses de distances standards pondérées par les effectifs de propriétaires et de locataires par secteur de recensement pour la ville de Sherbrooke en 2021 (<a href="#fig-CarteProprioLoctaires">figure&nbsp;<span>3.5</span></a>). D’emblée, nous constatons que les propriétaires ont une distribution plus dispersée que celle des locataires plus présents dans le centre de la ville.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-CarteProprioLoctaires" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CarteProprioLoctaires-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.5: Propriétaires et locataires dans la ville de Sherbrooke (avec ellipse de distance standard), 2021</figcaption></figure>
</div>
</div>
</div>
<p>Le code suivant permet d’obtenir l’indice de Wong <span class="citation" data-cites="wong1999geostatistics">(<a href="references.html#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Importation des deux ellipses </span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/EllipseProprio.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/EllipseLocataire.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="co">## Intersection </span></span>
<span><span class="va">Inter</span> <span class="op">&lt;-</span> <span class="fu">st_intersection</span><span class="op">(</span><span class="va">E1</span>, <span class="va">E2</span><span class="op">)</span></span>
<span><span class="co">## Union</span></span>
<span><span class="va">Union</span> <span class="op">&lt;-</span> <span class="fu">st_union</span><span class="op">(</span><span class="va">E1</span>, <span class="va">E2</span><span class="op">)</span></span>
<span><span class="co">## Calcul de l'indice de Wong</span></span>
<span><span class="va">Wong</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">st_area</span><span class="op">(</span><span class="va">Inter</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">st_area</span><span class="op">(</span><span class="va">Union</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Valeur de l'indice de Wong : "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Wong</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Valeur de l'indice de Wong : 0.515"</code></pre>
</div>
</div>
</section></section><section id="sec-0313" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-0313">
<span class="header-section-number">3.2.3</span> Mise en œuvre de l’analyse centrographique dans&nbsp;R</h3>
<section id="sec-03131" class="level4" data-number="3.2.3.1"><h4 data-number="3.2.3.1" class="anchored" data-anchor-id="sec-03131">
<span class="header-section-number">3.2.3.1</span> Calcul de mesures non pondérées</h4>
<p>Pour illustrer la mise en œuvre des différentes mesures de l’analyse centrographique dans&nbsp;R, nous utilisons un jeu de données ouvertes sur les <a href="https://donneesouvertes-sherbrooke.opendata.arcgis.com/datasets/64d19d62f0804f5896e4b24c32aea49d_0/explore?location=45.403468%2C-71.960143%2C12.00">incidents de sécurité publique de la ville de Sherbrooke</a>. Dans le code ci-dessous, nous importons les données et constituons une couche <code>sf</code> par année (2019 à 2022) et extrayons les coordonnées géographiques.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap">tmap</a></span><span class="op">)</span></span>
<span><span class="co">## Importation des données </span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/Arrondissements.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Incidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/IncidentsSecuritePublique.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Changement de projection</span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">Arrondissements</span>, crs <span class="op">=</span> <span class="fl">3798</span><span class="op">)</span> </span>
<span><span class="va">Incidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">Incidents</span>, crs <span class="op">=</span> <span class="fl">3798</span><span class="op">)</span></span>
<span><span class="co">## Extaction des méfaits</span></span>
<span><span class="va">Mefaits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Incidents</span>, <span class="va">DESCRIPTIO</span> <span class="op">==</span> <span class="st">"Méfait"</span><span class="op">)</span></span>
<span><span class="co"># Méfaits par année</span></span>
<span><span class="va">M2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Mefaits</span>, <span class="va">ANNEE</span><span class="op">==</span><span class="fl">2019</span><span class="op">)</span></span>
<span><span class="va">M2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Mefaits</span>, <span class="va">ANNEE</span><span class="op">==</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">M2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Mefaits</span>, <span class="va">ANNEE</span><span class="op">==</span><span class="fl">2021</span><span class="op">)</span></span>
<span><span class="va">M2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Mefaits</span>, <span class="va">ANNEE</span><span class="op">==</span><span class="fl">2022</span><span class="op">)</span></span>
<span><span class="co"># Coordonnées géographiques</span></span>
<span><span class="va">xy.2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span></span>
<span><span class="va">xy.2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span></span>
<span><span class="va">xy.2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span></span>
<span><span class="va">xy.2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2022</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les méfaits par année sont présentés à la <a href="#fig-CarteMefaits">figure&nbsp;<span>3.6</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-CarteMefaits" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CarteMefaits-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.6: Localisation des méfaits par année, ville de Sherbrooke, 2021</figcaption></figure>
</div>
</div>
</div>
<p><strong>Centre moyen</strong></p>
<p>Avec la fonction <code>mean</code>, nous pouvons calculer les valeurs moyennes sur les coordonnées <em>X</em> et <em>Y</em>, puis créer un objet <code>sf</code> avec les centres moyens.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Récupération de la projection cartographique dans une variable</span></span>
<span><span class="va">ProjCarto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">Mefaits</span><span class="op">)</span></span>
<span><span class="co">## Calcul du centre moyen pour une année (2019)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 649990.3 157059.3</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calcul pour toutes les années</span></span>
<span><span class="co"># vecteur pour les moyennes des X</span></span>
<span><span class="va">X.moy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Vecteur pour les moyennes des Y</span></span>
<span><span class="va">Y.moy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Enregistrement dans un objet sf</span></span>
<span><span class="va">CentreMoyen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Annee <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019"</span>, <span class="st">"2020"</span>, <span class="st">"2021"</span>, <span class="st">"2022"</span><span class="op">)</span>,</span>
<span>                          X <span class="op">=</span> <span class="va">X.moy</span>, </span>
<span>                          Y <span class="op">=</span> <span class="va">Y.moy</span>,</span>
<span>                          CMx <span class="op">=</span> <span class="va">X.moy</span>,  </span>
<span>                          CMy <span class="op">=</span> <span class="va">Y.moy</span><span class="op">)</span></span>
<span><span class="va">CentreMoyen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">CentreMoyen</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">ProjCarto</span><span class="op">)</span></span>
<span><span class="co"># Affichage des résultats</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">CentreMoyen</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
Projected CRS: NAD83 / MTQ Lambert
  Annee      CMx      CMy                  geometry
1  2019 649990.3 157059.3 POINT (649990.3 157059.3)
2  2020 649696.0 157544.8   POINT (649696 157544.8)
3  2021 650663.7 157214.8 POINT (650663.7 157214.8)
4  2022 650442.5 157237.0   POINT (650442.5 157237)</code></pre>
</div>
</div>
<p><strong>Point central</strong></p>
<p>Le code ci-dessous illustre comment identifier le point central, qui fait partie du jeu de données, pour l’année&nbsp;2019.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calcul de la matrice de distances entre les points de l'année 2019</span></span>
<span><span class="va">DistMatrice2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">xy.2019</span>, method <span class="op">=</span> <span class="st">"euclidean"</span>, diag <span class="op">=</span> <span class="cn">TRUE</span>, upper <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Somme de chaque ligne de la matrice, soit la somme des distances à tous les autres points</span></span>
<span><span class="va">M2019</span><span class="op">$</span><span class="va">DistATous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">DistMatrice2019</span><span class="op">)</span></span>
<span><span class="co">## Sélection du point avec plus petite distance à tous les autres</span></span>
<span><span class="va">PointCentral2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">M2019</span>, <span class="va">M2019</span><span class="op">$</span><span class="va">DistATous</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">$</span><span class="va">DistATous</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Distance standard sur les coordonnées <em>X</em> et <em>Y</em> et distance standard combinée</strong></p>
<p>Le code ci-dessous permet de calculer les trois distances standards.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calcul de la distance standard pour une année (2019)</span></span>
<span><span class="co"># Distance standard sur les coordonnées X et Y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3732.173 2593.207</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Distance standard</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>            <span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4544.649</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calcul pour toutes les années et enregistrement des centres moyens dans de nouveaux champs</span></span>
<span><span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS.Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                              <span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2019</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                              <span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2020</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="op">+</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                              <span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2021</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="op">+</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                              <span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xy.2022</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Visualisation des résultats</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">CentreMoyen</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 6 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
Projected CRS: NAD83 / MTQ Lambert
  Annee      CMx      CMy                  geometry     DS.X     DS.Y       DS
1  2019 649990.3 157059.3 POINT (649990.3 157059.3) 3732.173 2593.207 4544.649
2  2020 649696.0 157544.8   POINT (649696 157544.8) 4134.913 2393.048 4777.466
3  2021 650663.7 157214.8 POINT (650663.7 157214.8) 3374.821 2294.171 4080.764
4  2022 650442.5 157237.0   POINT (650442.5 157237) 3601.208 2170.215 4204.585</code></pre>
</div>
</div>
<p><strong>Représentations graphiques de la dispersion</strong></p>
<p>Une fois que la couche <code>sf</code> des centres moyens avec les trois champs pour la distance standard est créée, il suffit de tracer un rectangle et un cercle de distance standard.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Enveloppe convexe</span></span>
<span><span class="va">sf.Enveloppes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019"</span>, <span class="st">"2020"</span>, <span class="st">"2021"</span>, <span class="st">"2022"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    geometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_convex_hull</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">M2022</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rectangle avec les distances standards sur les coordonnées X et Y</span></span>
<span><span class="co">#' Fonction pour tracer le rectangle</span></span>
<span><span class="co">#' @param MoyX coordonnées X du centre moyen.</span></span>
<span><span class="co">#' @param MoyY coordonnées Y du centre moyen.</span></span>
<span><span class="co">#' @param SDx distance standard sur les coordonnées X.</span></span>
<span><span class="co">#' @param SDy distance standard sur les coordonnées Y.</span></span>
<span><span class="co">#' @param crs projection cartographique.</span></span>
<span><span class="va">CreationRec</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">MoyX</span>, <span class="va">MoyY</span>, <span class="va">SDx</span>, <span class="va">SDy</span>, <span class="va">ProjCarto</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pt1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MoyX</span> <span class="op">-</span> <span class="va">SDx</span>, <span class="va">MoyY</span> <span class="op">-</span> <span class="va">SDy</span><span class="op">)</span></span>
<span>  <span class="va">pt2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MoyX</span> <span class="op">-</span> <span class="va">SDx</span>, <span class="va">MoyY</span> <span class="op">+</span> <span class="va">SDy</span><span class="op">)</span></span>
<span>  <span class="va">pt3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MoyX</span> <span class="op">+</span> <span class="va">SDx</span>, <span class="va">MoyY</span> <span class="op">+</span> <span class="va">SDy</span><span class="op">)</span></span>
<span>  <span class="va">pt4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MoyX</span> <span class="op">+</span> <span class="va">SDx</span>, <span class="va">MoyY</span> <span class="op">-</span> <span class="va">SDy</span><span class="op">)</span></span>
<span>  <span class="va">Rectangle</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">pt1</span>, <span class="va">pt2</span>, <span class="va">pt3</span>, <span class="va">pt4</span>, <span class="va">pt1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Rectangle</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span><span class="va">Rectangle</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">Rectangle</span><span class="op">)</span> <span class="op">=</span> <span class="va">ProjCarto</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Rectangle</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">MoyX</span> <span class="op">&lt;-</span> <span class="va">CentreMoyen</span><span class="op">$</span><span class="va">CMx</span></span>
<span><span class="va">MoyY</span> <span class="op">&lt;-</span> <span class="va">CentreMoyen</span><span class="op">$</span><span class="va">CMy</span></span>
<span><span class="va">SDx</span> <span class="op">&lt;-</span> <span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS.X</span></span>
<span><span class="va">SDy</span> <span class="op">&lt;-</span> <span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS.Y</span></span>
<span><span class="va">sf.Rectangles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019"</span>, <span class="st">"2020"</span>, <span class="st">"2021"</span>, <span class="st">"2022"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    geometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">CreationRec</span><span class="op">(</span><span class="va">MoyX</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">MoyY</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">SDx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">SDy</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ProjCarto</span><span class="op">)</span>,</span>
<span>                                 <span class="fu">CreationRec</span><span class="op">(</span><span class="va">MoyX</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">MoyY</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">SDx</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">SDy</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ProjCarto</span><span class="op">)</span>,</span>
<span>                                 <span class="fu">CreationRec</span><span class="op">(</span><span class="va">MoyX</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">MoyY</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">SDx</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">SDy</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">ProjCarto</span><span class="op">)</span>,</span>
<span>                                 <span class="fu">CreationRec</span><span class="op">(</span><span class="va">MoyX</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">MoyY</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">SDx</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">SDy</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">ProjCarto</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Cercle de distance standard avec la fonction st_buffer</span></span>
<span><span class="va">sf.CercleDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">CentreMoyen</span>, dist <span class="op">=</span> <span class="va">CentreMoyen</span><span class="op">$</span><span class="va">DS</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le calcul de l’ellipse est un peu plus complexe. Par conséquent, nous avons écrit deux fonctions&nbsp;:</p>
<ul>
<li><p><code>CreateEllipse</code> qui construit une ellipse à partir d’une couche <code>sf</code> de points.</p></li>
<li><p><code>CreateEllipse_gp</code> qui construit des ellipses à partir d’une couche <code>sf</code> de points en fonction d’une colonne indiquant différents groupes de points (ici, les différentes années).</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Appel des deux fonctions dans le fichier ellipses.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"code_complementaire/ellipses.R"</span><span class="op">)</span></span>
<span><span class="co">## Création d'une ellipse pour une année </span></span>
<span><span class="va">sf.Ellipse2019</span> <span class="op">&lt;-</span> <span class="fu">CreateEllipse</span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span></span>
<span><span class="co">## Création de plusieurs ellipses regroupées selon les différentes années</span></span>
<span><span class="va">sf.Ellipse</span> <span class="op">&lt;-</span> <span class="fu">CreateEllipse_gp</span><span class="op">(</span>points <span class="op">=</span> <span class="va">Mefaits</span>, group <span class="op">=</span> <span class="st">"ANNEE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sf.Ellipse</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4 features and 12 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 643833.8 ymin: 153377.3 xmax: 655559 ymax: 160937.9
Projected CRS: NAD83 / MTQ Lambert
       CMx      CMy   Sigmax   Sigmay       Lx        Ly     Aire    Theta
1 649990.3 157059.3 3055.157 5683.790 6110.315 11367.580 54553357 64.60944
2 649696.0 157544.8 3154.712 5994.647 6309.423 11989.294 59411858 75.81068
3 650663.7 157214.8 3128.891 4869.299 6257.783  9738.598 47863757 76.14675
4 650442.5 157237.0 2540.594 5406.184 5081.187 10812.368 43149511 68.52718
  ThetaCorr  Major  Minor                       geometry ANNEE
1  64.60944 SigmaY SigmaX POLYGON ((655125.1 159496.4...  2019
2  75.81068 SigmaY SigmaX POLYGON ((655507.7 159014.3...  2020
3  76.14675 SigmaY SigmaX POLYGON ((655391.4 158380.7...  2021
4  68.52718 SigmaY SigmaX POLYGON ((655473.5 159216, ...  2022</code></pre>
</div>
</div>
<p>Les quatre représentations de la dispersion sont présentées à la <a href="#fig-RepresentationDispersion">figure&nbsp;<span>3.7</span></a>&nbsp;: 1)&nbsp;enveloppe convexe (gris), 2)&nbsp;cercle de distance standard (bleu), 3)&nbsp;rectangle de distance standard sur les X et Y (noir) et 4)&nbsp;ellipse de distance standard (rouge).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-RepresentationDispersion" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-RepresentationDispersion-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.7: Représentations de la dispersion des méfaits pour les quatre années</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-03132" class="level4" data-number="3.2.3.2"><h4 data-number="3.2.3.2" class="anchored" data-anchor-id="sec-03132">
<span class="header-section-number">3.2.3.2</span> Calcul de mesures pondérées</h4>
<p>Pour illustrer le calcul des mesures pondérées, nous utilisons des données sur les effectifs des premier et dernier déciles de revenu après impôt des familles économiques pour les secteurs de recensement de la ville de Sherbrooke en 2021 (<a href="#fig-CartesDecilesPremierDernier">figure&nbsp;<span>3.8</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-CartesDecilesPremierDernier" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CartesDecilesPremierDernier-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.8: Déciles extrêmes de revenu après impôt des familles économiques</figcaption></figure>
</div>
</div>
</div>
<p>Le code suivant permet d’importer et de structurer les données, puis de calculer les différentes mesures (centre moyen pondéré et distance standard pondérée).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Importation et structuration des données</span></span>
<span><span class="va">dfdecile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/chap03/DataDecilesSR.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="va">dfdecile</span><span class="op">$</span><span class="va">SRIDU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dfdecile</span><span class="op">$</span><span class="va">SRIDU</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/Recen2021Sherbrooke.gpkg"</span>,</span>
<span>              layer <span class="op">=</span> <span class="st">"DR_SherbSRDonnees2021"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">SR</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SRIDU"</span><span class="op">)</span><span class="op">]</span>, <span class="va">dfdecile</span>, by <span class="op">=</span> <span class="st">"SRIDU"</span><span class="op">)</span></span>
<span><span class="va">ProjCarto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span></span>
<span><span class="co">## Coordonnées géographiques des secteurs de recensement</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_point_on_surface</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Pondérations pour les deux déciles</span></span>
<span><span class="va">wd1</span>  <span class="op">&lt;-</span> <span class="va">SR</span><span class="op">$</span><span class="va">D1</span></span>
<span><span class="va">wd10</span> <span class="op">&lt;-</span> <span class="va">SR</span><span class="op">$</span><span class="va">D10</span></span>
<span><span class="co">## Sommes des pondérations</span></span>
<span><span class="va">swd1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd1</span><span class="op">)</span></span>
<span><span class="va">swd10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd10</span><span class="op">)</span></span>
<span><span class="co">## Calcul du centre pondéré</span></span>
<span><span class="va">XmoyD1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">wd1</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd1</span></span>
<span><span class="va">XmoyD10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">wd10</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd10</span></span>
<span><span class="va">YmoyD1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">wd1</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd1</span></span>
<span><span class="va">YmoyD10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">wd10</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd10</span></span>
<span><span class="va">CentreMoyenPond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Decile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Premier"</span>, <span class="st">"Dernier"</span><span class="op">)</span>,</span>
<span>                          X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">XmoyD1</span>, <span class="va">XmoyD10</span><span class="op">)</span>, </span>
<span>                          Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">YmoyD1</span>, <span class="va">YmoyD10</span><span class="op">)</span>,</span>
<span>                          CMwx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">XmoyD1</span>, <span class="va">XmoyD10</span><span class="op">)</span>,  </span>
<span>                          CMwy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">YmoyD1</span>, <span class="va">YmoyD10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CentreMoyenPond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">CentreMoyenPond</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">ProjCarto</span><span class="op">)</span></span>
<span><span class="co">## Calcul de la distance standard pondérée</span></span>
<span><span class="va">sdD1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd1</span><span class="op">*</span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">-</span> <span class="va">XmoyD1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd1</span><span class="op">*</span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span> <span class="va">YmoyD1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sdD10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd10</span><span class="op">*</span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">-</span> <span class="va">XmoyD10</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wd10</span><span class="op">*</span><span class="op">(</span><span class="va">xy</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span> <span class="va">YmoyD10</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">swd10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Zones tampons avec la distance standard pondérée</span></span>
<span><span class="va">CentreMoyenPond</span><span class="op">$</span><span class="va">SDw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sdD1</span>, <span class="va">sdD10</span><span class="op">)</span></span>
<span><span class="va">sf.CercleDSW</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">CentreMoyenPond</span>, dist <span class="op">=</span> <span class="va">CentreMoyenPond</span><span class="op">$</span><span class="va">SDw</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calcul de l'ellipse pondérée pour le premier décile</span></span>
<span><span class="va">SR.points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_point_on_surface</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span></span>
<span><span class="va">ellipse.D1</span> <span class="op">&lt;-</span> <span class="fu">CreateEllipse</span><span class="op">(</span><span class="va">SR.points</span>, w <span class="op">=</span> <span class="va">SR.points</span><span class="op">$</span><span class="va">D1</span><span class="op">)</span></span>
<span><span class="va">ellipse.D10</span> <span class="op">&lt;-</span> <span class="fu">CreateEllipse</span><span class="op">(</span><span class="va">SR.points</span>, w <span class="op">=</span> <span class="va">SR.points</span><span class="op">$</span><span class="va">D10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Carte 1 : premier décile</span></span>
<span><span class="va">Carte1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"whitesmoke"</span>, border.col <span class="op">=</span> <span class="st">"grey30"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CentreMoyenPond</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">sf.CercleDSW</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>      </span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ellipse.D1</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>    </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"A. Premier décile (le plus pauvre)"</span>,</span>
<span>            main.title.size <span class="op">=</span> <span class="fl">.9</span>, frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Carte 2 : dernier décile</span></span>
<span><span class="va">Carte2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"whitesmoke"</span>, border.col <span class="op">=</span> <span class="st">"grey30"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">CentreMoyenPond</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">.5</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">sf.CercleDSW</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>         </span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ellipse.D10</span><span class="op">)</span><span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span>    </span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"B. Dernier décile (le plus riche)"</span>,</span>
<span>            main.title.size <span class="op">=</span> <span class="fl">.9</span>, frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_credits.html">tm_credits</a></span><span class="op">(</span><span class="st">"Source : recensement de 2021, Statistique Canada\nAuteur : Jéremy Lécartemplace."</span>, </span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"bottom"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, align <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span><span class="co"># Combinaison des deux cartes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-MesuresPonderees" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-MesuresPonderees-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.9: Cercles de distance standard et ellipses pondérés</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-033" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="sec-033">
<span class="header-section-number">3.3</span> Forme d’un semis de points</h2>
<p>Étudier la forme d’un semis de points, c’est vouloir décrire l’arrangement spatial et l’espacement des points dans une région donnée. Autrement dit, l’objectif est de répondre à la question suivante&nbsp;: comment se répartissent les points dans une région donnée? Nous distinguons habituellement trois types de distribution spatiale d’un semis de points (<a href="#fig-FormeSemisDePoints3Types">figure&nbsp;<span>3.10</span></a>)&nbsp;:</p>
<ol type="1">
<li>
<strong>Distribution dispersée</strong> quand les points du semis sont régulièrement espacés.</li>
<li>
<strong>Distribution aléatoire</strong> quand la distribution des points n’est nullement guidée par des considérations géographiques. Autrement dit, chaque point du semis a la même probabilité d’être situé dans n’importe quelle partie de la zone d’étude.</li>
<li>
<strong>Distribution concentrée</strong> quand il existe des regroupements de points dans une ou plusieurs parties de la région d’étude. Par exemple, les musées et les théâtres sont habituellement concentrés dans les parties centrales des métropoles.</li>
</ol>
<div id="fig-FormeSemisDePoints3Types" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/FigureTroisTypesDistributions.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.10: Trois types de distribution spatiale d’un semis de points</figcaption></figure>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Deux grandes familles pour décrire la forme d’un semis de points</strong></p>
</div>
<div class="bloc_attention-body">
<ol type="1">
<li>Celles basées sur la distance (l’indice du plus proche voisin, fonctions <em>K</em> et <em>L</em> de Ripley) (<a href="#sec-0331">section&nbsp;<span>3.3.1</span></a>).</li>
<li>Celles basées sur la densité (méthode des quadrats avec différents tests statistiques) (<a href="#sec-0332">section&nbsp;<span>3.3.2</span></a>).</li>
</ol>
</div>
</div>
<section id="sec-0331" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="sec-0331">
<span class="header-section-number">3.3.1</span> Méthode du plus proche voisin</h3>
<p>Le principe de base de cette méthode est fort simple et se décompose en quatre étapes :</p>
<ol type="1">
<li><p>Mesurer, pour chaque point du semis, la distance le séparant du point le plus proche, puis calculer la distance moyenne du point le plus proche (<a href="#eq-PlusProcheVoisinRobs">équation&nbsp;<span>3.20</span></a>).</p></li>
<li><p>Calculer la moyenne attendue du point le plus proche pour une dispersion aléatoire (<a href="#eq-PlusProcheVoisinR">équation&nbsp;<span>3.22</span></a>).</p></li>
<li>
<p>Calculer l’indice du plus proche voisin, soit le ratio entre la distance observée et la distance aléatoire (<a href="#eq-PlusProcheVoisinRExp">équation&nbsp;<span>3.21</span></a>). L’indice <em>R</em> s’interprète alors comme suit&nbsp;:</p>
<ul>
<li>Si <em>R</em> est égal à 1, la dispersion du semis de points est aléatoire.</li>
<li>Si <em>R</em> est inférieur à 1, la distribution du semis de points tend vers la concentration (avec une concentration absolue quand <em>R</em>&nbsp;=&nbsp;0; tous les points ont les mêmes coordonnées géographiques).</li>
<li>Si <em>R</em> est supérieur à 1, la distribution du semis de points tend vers la dispersion.</li>
</ul>
</li>
<li><p>Calculer les valeurs de <em>Z</em> et de <em>p</em> pour déterminer si la valeur de <em>R</em> obtenue est significative (<a href="#eq-PlusProcheVoisinZ">équation&nbsp;<span>3.23</span></a>).</p></li>
</ol>
<p><span id="eq-PlusProcheVoisinRobs"><span class="math display">\[
R_{o}= \frac{\sum_{i=1}^n d_i}{n}
\tag{3.20}\]</span></span></p>
<p><span id="eq-PlusProcheVoisinRExp"><span class="math display">\[
R_{a}= \frac{1}{2 \sqrt{(n/S)}}
\tag{3.21}\]</span></span></p>
<p><span id="eq-PlusProcheVoisinR"><span class="math display">\[
R = \frac{R_{o}}{R_{a}}
\tag{3.22}\]</span></span></p>
<p><span id="eq-PlusProcheVoisinZ"><span class="math display">\[
Z = \frac{R_o-R_a}{SE} \text{, } SE = \frac{0.26136}{\sqrt{(n^2/S)}} \text{ avec :}
\tag{3.23}\]</span></span></p>
<ul>
<li>
<span class="math inline">\(n\)</span>, nombre de points.</li>
<li>
<span class="math inline">\(d_i\)</span>, distance séparant le point <em>i</em> de son voisin le plus proche.</li>
<li>
<span class="math inline">\(S\)</span>, superficie de l’espace d’étude.</li>
</ul>
<p>Le code ci-dessous permet de mettre en œuvre la méthode du plus proche voisin pour les méfaits pour les quatre années.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/">spatstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">## Indice du plus proche voisin : R observé (équation 3.20)</span></span>
<span><span class="co"># le paramètre k indique le nombre de plus proches voisins</span></span>
<span><span class="va">Robs2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Robs2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Robs2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Robs2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2022</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Indice du plus proche voisin : R attendu (distribution aléatoire) (équation 3.21)</span></span>
<span><span class="co"># Attention, il faut spéficier S, la superficie de l'espace d'étude</span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/Arrondissements.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">Arrondissements</span>, crs <span class="op">=</span> <span class="fl">3798</span><span class="op">)</span> </span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Nombre de points par année</span></span>
<span><span class="va">N2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span></span>
<span><span class="va">N2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span></span>
<span><span class="va">N2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span></span>
<span><span class="va">N2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">M2022</span><span class="op">)</span></span>
<span><span class="co"># Calcul de Ra</span></span>
<span><span class="va">Ra2019</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N2019</span> <span class="op">/</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Ra2020</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N2020</span> <span class="op">/</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Ra2021</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N2021</span> <span class="op">/</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Ra2022</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">N2022</span> <span class="op">/</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Calculons le R</span></span>
<span><span class="co"># Création d'un DataFrame</span></span>
<span><span class="va">IndicePPV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2019"</span>, <span class="st">"2020"</span>, <span class="st">"2021"</span>, <span class="st">"2022"</span><span class="op">)</span>,</span>
<span>                               points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N2019</span>, <span class="va">N2020</span>, <span class="va">N2021</span>, <span class="va">N2022</span><span class="op">)</span>,</span>
<span>                               Superficie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">S</span>, <span class="va">S</span>, <span class="va">S</span><span class="op">)</span>,</span>
<span>                               Robs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Robs2019</span>, <span class="va">Robs2020</span>, <span class="va">Robs2021</span>, <span class="va">Robs2022</span><span class="op">)</span>,</span>
<span>                               Rattendu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Ra2019</span>, <span class="va">Ra2020</span>, <span class="va">Ra2021</span>, <span class="va">Ra2022</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Calcul du R (équation 3.22)</span></span>
<span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">IndicePPV</span><span class="op">$</span><span class="va">Robs</span> <span class="op">/</span> <span class="va">IndicePPV</span><span class="op">$</span><span class="va">Rattendu</span></span>
<span><span class="co"># Calcul du Z (équation 3.23)</span></span>
<span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="fl">0.26136</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">points</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">IndicePPV</span><span class="op">$</span><span class="va">Superficie</span><span class="op">)</span></span>
<span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">Robs</span> <span class="op">-</span> <span class="va">IndicePPV</span><span class="op">$</span><span class="va">Rattendu</span><span class="op">)</span> <span class="op">/</span> <span class="va">IndicePPV</span><span class="op">$</span><span class="va">SE</span></span>
<span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">IndicePPV</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">IndicePPV</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    id points Superficie     Robs Rattendu         R       SE         Z P
1 2019    251  366358191 251.5498 604.0684 0.4164260 19.93051 -17.68739 0
2 2020    383  366358191 183.9866 489.0166 0.3762380 13.06151 -23.35335 0
3 2021    344  366358191 227.1881 515.9929 0.4402931 14.54232 -19.85961 0
4 2022    220  366358191 251.3347 645.2256 0.3895299 22.73890 -17.32234 0</code></pre>
</div>
</div>
<p><strong>Interprétation des résultats</strong></p>
<p>Analysons les différentes colonnes du <a href="#tbl-TableauMPPV">tableau&nbsp;<span>3.3</span></a> :</p>
<ul>
<li><p><strong>points (n)&nbsp;:</strong> il y a respectivement 251, 383, 344 et 220 méfaits pour les années 2019 à 2022.</p></li>
<li><p><strong><em>R</em></strong> <strong>observé&nbsp;:</strong> en moyenne, un méfait est distant de 252, 184, 227 et 251&nbsp;mètres du méfait le plus proche pour les quatre années.</p></li>
<li><p><strong><em>R</em></strong> <strong>attendu&nbsp;:</strong> pour une distribution aléatoire, un méfait devrait être distant du méfait le plus proche de 604, 489, 516, et 645&nbsp;mètres.</p></li>
<li><p><strong>Indice du plus proche voisin&nbsp;:</strong> toutes les valeurs sont inférieures à&nbsp;1, indiquant des distributions spatiales concentrées. La concentration est la plus forte pour l’année 2020 (R&nbsp;=&nbsp;0,376).</p></li>
<li><p><strong>valeur de <em>p</em>&nbsp;:</strong> toutes les valeurs sont égales à 0, signalant que les résultats sont significatifs.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-TableauMPPV" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;3.3: Résultats de la méthode du plus proche voisin pour les méfaits par année</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 26%">
<col style="width: 16%">
<col style="width: 8%">
<col style="width: 4%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Année</th>
<th style="text-align: center;">points (n)</th>
<th style="text-align: center;">
<em>R</em> observé</th>
<th style="text-align: center;">
<em>R</em> attendu</th>
<th style="text-align: center;">Indice plus proche voisin</th>
<th style="text-align: center;">Erreur standard</th>
<th style="text-align: center;">Z</th>
<th style="text-align: center;"><em>p</em></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2019</td>
<td style="text-align: center;">251</td>
<td style="text-align: center;">252</td>
<td style="text-align: center;">604</td>
<td style="text-align: center;">0,416</td>
<td style="text-align: center;">19,931</td>
<td style="text-align: center;">-17,687</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020</td>
<td style="text-align: center;">383</td>
<td style="text-align: center;">184</td>
<td style="text-align: center;">489</td>
<td style="text-align: center;">0,376</td>
<td style="text-align: center;">13,062</td>
<td style="text-align: center;">-23,353</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2021</td>
<td style="text-align: center;">344</td>
<td style="text-align: center;">227</td>
<td style="text-align: center;">516</td>
<td style="text-align: center;">0,440</td>
<td style="text-align: center;">14,542</td>
<td style="text-align: center;">-19,860</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2022</td>
<td style="text-align: center;">220</td>
<td style="text-align: center;">251</td>
<td style="text-align: center;">645</td>
<td style="text-align: center;">0,390</td>
<td style="text-align: center;">22,739</td>
<td style="text-align: center;">-17,322</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Notez qu’il est possible aussi de construire un graphique pour le <em>R</em> observé avec plusieurs voisins, tel que réalisé avec le code ci-dessous avec <em>k</em>&nbsp;=&nbsp;1 à 50 (<a href="#fig-IndicePlusProchVoisin150">figure&nbsp;<span>3.11</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># k = 1 à 50</span></span>
<span><span class="va">Robs2019N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2019</span><span class="op">)</span>, k<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">Robs2020N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span>, k<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">Robs2021N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span>, k<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">Robs2022N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/nndist.html">nndist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2022</span><span class="op">)</span>, k<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span>
<span><span class="co"># Enregistrement dans des dataFrames</span></span>
<span><span class="va">Robs2019N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>An<span class="op">=</span><span class="st">"2019"</span>, Voisins<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Robs2019N1_50</span><span class="op">)</span>, Robs<span class="op">=</span><span class="va">Robs2019N1_50</span><span class="op">)</span></span>
<span><span class="va">Robs2020N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>An<span class="op">=</span><span class="st">"2020"</span>, Voisins<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Robs2020N1_50</span><span class="op">)</span>, Robs<span class="op">=</span><span class="va">Robs2020N1_50</span><span class="op">)</span></span>
<span><span class="va">Robs2021N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>An<span class="op">=</span><span class="st">"2021"</span>, Voisins<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Robs2021N1_50</span><span class="op">)</span>, Robs<span class="op">=</span><span class="va">Robs2021N1_50</span><span class="op">)</span></span>
<span><span class="va">Robs2022N1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>An<span class="op">=</span><span class="st">"2022"</span>, Voisins<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Robs2022N1_50</span><span class="op">)</span>, Robs<span class="op">=</span><span class="va">Robs2022N1_50</span><span class="op">)</span></span>
<span><span class="co"># Combinaison des dataFrames en un seul</span></span>
<span><span class="va">RobsN1_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">Robs2019N1_50</span>, <span class="va">Robs2020N1_50</span>, <span class="va">Robs2021N1_50</span>, <span class="va">Robs2022N1_50</span><span class="op">)</span></span>
<span><span class="co"># Création du graphique</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">RobsN1_50</span><span class="op">)</span><span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Voisins</span>, y <span class="op">=</span> <span class="va">Robs</span>, color <span class="op">=</span> <span class="va">An</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Voisins</span>, y <span class="op">=</span> <span class="va">Robs</span>, color <span class="op">=</span> <span class="va">An</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Nombre de voisins"</span>,</span>
<span>     y <span class="op">=</span> <span class="st">"Robs - Distance en mètres"</span>,</span>
<span>     color <span class="op">=</span> <span class="st">"Année"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-IndicePlusProchVoisin150" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-IndicePlusProchVoisin150-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.11: Distance au plus proche voisin de 1 à 50</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-0332" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="sec-0332">
<span class="header-section-number">3.3.2</span> Méthode des quadrats</h3>
<section id="sec-03231" class="level4" data-number="3.3.2.1"><h4 data-number="3.3.2.1" class="anchored" data-anchor-id="sec-03231">
<span class="header-section-number">3.3.2.1</span> Principe de base</h4>
<p>Le principe de base de la méthode des quadrats peut être décomposé en trois étapes&nbsp;:</p>
<ol type="1">
<li>Superposer à la région d’étude comprenant le semis de points un ensemble de <strong>quadrats</strong> (habituellement une grille régulière formée d’un ensemble de carrés).</li>
<li>Compter le nombre de points compris dans chacun des quadrats. De la sorte, certains quadrats ne comprennent aucun point tandis que d’autres en contiennent un, deux, trois, etc. Nous obtenons ainsi un tableau des fréquences.</li>
<li>Réaliser des tests statistiques à partir des fréquences observées et théoriques pour qualifier la distribution du semis de points (test de Kolmogorov-Smirnov, test du khi-deux ou méthode Monte-Carlo).</li>
</ol></section><section id="sec-03252" class="level4" data-number="3.3.2.2"><h4 data-number="3.3.2.2" class="anchored" data-anchor-id="sec-03252">
<span class="header-section-number">3.3.2.2</span> Forme, distribution et taille des quadrats</h4>
<p>Il est possible de paramétrer les quadrats selon leur forme, leur distribution et leur taille. Habituellement, la forme retenue pour les quadrats est le carré, mais d’autres formes géométriques peuvent être utilisées comme l’hexagone et plus rarement, le cercle. La distribution des quadrats peut aussi être soit régulière, soit aléatoire (<a href="#fig-FormeQuadrats">figure&nbsp;<span>3.12</span></a>). Notez que dans le cas d’un cercle, le maillage ne peut être qu’irrégulier puisque certains points risqueraient de ne pas être contenus dans un cercle pour un maillage régulier.</p>
<div id="fig-FormeQuadrats" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/FormesQuadrats.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.12: Formes et distributions de quadrats</figcaption></figure>
</div>
<p>Bien entendu, les résultats varient selon la taille des quadrats. Par exemple, dans le cas d’une distribution spatiale concentrée d’un semis de points, diminuer la taille des quadrats risque d’augmenter la perception de la dispersion. Certains auteurs proposent alors une formule pour déterminer la superficie optimale du quadrat <span class="citation" data-cites="wong2005statistical mitchel2005esri">(<a href="references.html#ref-wong2005statistical" role="doc-biblioref">Wong et Lee 2005</a>; <a href="references.html#ref-mitchel2005esri" role="doc-biblioref">Mitchel 2005</a>)</span>&nbsp;:</p>
<p><span id="eq-TailleQuadrat"><span class="math display">\[
S_q = \frac{2S}{n}
\tag{3.24}\]</span></span></p>
<p><span id="eq-TailleQuadratLongueur"><span class="math display">\[
l_q = \sqrt{S_q} \text{ et } r_q = \sqrt{\frac{S_q}{\pi}} \text{ et } l_a = \sqrt{ \frac{2S_q}{3 \sqrt{3}}} \text{ avec :}
\tag{3.25}\]</span></span></p>
<ul>
<li>
<span class="math inline">\(S_q\)</span>, superficie du quadrat.</li>
<li>
<span class="math inline">\(n\)</span>, nombre de points dans le semis.</li>
<li>
<span class="math inline">\(l_q\)</span>, longueur du côté si la forme du quadrat est un carré.</li>
<li>
<span class="math inline">\(r_q\)</span>, longueur du rayon si la forme du quadrat est un cercle.</li>
<li>
<span class="math inline">\(l_a\)</span>, longueur du côté d’un hexagone régulier.</li>
</ul></section><section id="sec-03253" class="level4" data-number="3.3.2.3"><h4 data-number="3.3.2.3" class="anchored" data-anchor-id="sec-03253">
<span class="header-section-number">3.3.2.3</span> Tests statistiques</h4>
<p><strong>Construction du tableau de fréquences observées et théoriques</strong></p>
<p>Une fois les quadrats créés, nous devons compter le nombre de points compris dans chacun d’eux. Une distribution spatiale concentrée à l’extrême se traduit par la localisation de tous les points du semis d’un seul quadrat, tandis que pour une distribution dispersée maximale se traduit par le fait que tous les quadrats contiennent le même nombre de points. Par la suite, nous construisons un tableau de fréquences.</p>
<p>Prenons deux situations à la <a href="#fig-FormeQuadratsExemple">figure&nbsp;<span>3.13</span></a>&nbsp;:</p>
<ol type="1">
<li>
<strong>A. Une distribution dispersée</strong>, puisque les points sont présents dans la plupart des quadrats.</li>
<li>
<strong>B. Une distribution concentrée</strong>, puisque les points sont localisés dans quelques quadrats.</li>
</ol>
<p>Notez que pour les deux situations, nous avons 42 points (<span class="math inline">\(n\)</span>) et 36 quadrats (<span class="math inline">\(k\)</span>), soit une moyenne de 1,167&nbsp;point par quadrat (<span class="math inline">\(\lambda = n / k = 42 / 36 = 1,167\)</span>). Détaillons les différentes colonnes du tableau de fréquences observées et théoriques&nbsp;:</p>
<ul>
<li><p><strong>Fréquences observées (</strong><span class="math inline">\(f_o\)</span>)&nbsp;: pour la situation&nbsp;A, nous avons 16&nbsp;quadrats qui ne comprennent aucun point, 4&nbsp;quadrats avec 1&nbsp;point, 10&nbsp;quadrats avec 2&nbsp;points et finalement 6&nbsp;quadrats avec 3&nbsp;points. À l’inverse, pour la situation&nbsp;B, 27&nbsp;quadrats sur les 36 ne comprennent aucun point, suggérant ainsi une concentration plus forte!</p></li>
<li><p><strong>Proportions observées&nbsp;:</strong> simplement les fréquences observées divisées par le nombre total de quadrats (par exemple, <span class="math inline">\(16 / 36 = 0,444\)</span> pour A).</p></li>
<li><p><strong>Proportions théoriques&nbsp;:</strong> à partir de la loi de probabilité de Poisson (<a href="#eq-QuadratPoisson">équation&nbsp;<span>3.26</span></a>), il est possible de calculer les proportions théoriques que nous devrions avoir si les points étaient distribués aléatoirement. Pas de panique avec la lecture de la formule, nous verrons qu’il existe une fonction pour la calculer facilement dans R. Nous calculons aussi les <strong>proportions théoriques cumulées</strong>.</p></li>
<li><p><strong>Fréquences théoriques&nbsp;:</strong> les fréquences théoriques sont simplement les proportions théoriques multipliées par le nombre de quadrats (par exemple, <span class="math inline">\(\text{0,311} \times 36 = \text{11,196}\)</span>).</p></li>
</ul>
<p><span id="eq-QuadratPoisson"><span class="math display">\[
p(x = k )= \frac{\lambda^k e^{-\lambda}}{x!}\text{ avec :}
\tag{3.26}\]</span></span></p>
<p><span class="math inline">\(\lambda \text{ (lambda)} = n / k\)</span>, soit le nombre moyen de points (<span class="math inline">\(n\)</span>) par quadrat (<span class="math inline">\(k\)</span>); <span class="math inline">\(x\)</span>, le nombre de points dans le quadrat (0, 1, 2, etc.); <span class="math inline">\(!x\)</span>, la factorielle d’un nombre (par exemple, <span class="math inline">\(!3 = 1 \times 2 \times 3 = 6\)</span>); <span class="math inline">\(e\)</span>, la constante de l’Euler, soit <span class="math inline">\(exp(1) = \text{2,718282}\)</span>.</p>
<p>À partir de ce tableau des fréquences observées et théoriques, nous pouvons calculer les tests de Kolmogorov-Smirnov et du khi-deux.</p>
<div id="fig-FormeQuadratsExemple" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/FormesQuadratsExemple.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.13: Illustrations des tests statistiques sur les quadrats</figcaption></figure>
</div>
<p><strong>Test statistique de Kolmogorov-Smirnov</strong></p>
<p>Ce test se décompose en six étapes&nbsp;:</p>
<ol type="1">
<li><p>Formuler l’hypothèse nulle stipulant que les fréquences observées et théoriques ne sont pas statistiquement différentes (<span class="math inline">\(H_0\)</span>).</p></li>
<li><p>Choisir un seuil de signification pour valider ou réfuter l’hypothèse nulle (par exemple, <span class="math inline">\(\alpha = \text{0,05}\)</span>).</p></li>
<li><p>Calculer la différence absolue entre les proportions cumulées observées et théoriques.</p></li>
<li><p>Calculer la statistique <span class="math inline">\(D\)</span>, soit la plus forte valeur des différences absolues entre les fréquences cumulées observées et théoriques (<a href="#eq-DValeurKS">équation&nbsp;<span>3.27</span></a>).</p></li>
<li><p>Calculer la valeur critique pour une distribution aléatoire avec un seuil de signification <span class="math inline">\(\alpha\)</span> (<a href="#eq-DValeurKSCritique">équation&nbsp;<span>3.28</span></a>).</p></li>
<li>
<p>Comparer les valeurs de <span class="math inline">\(D\)</span> et de <span class="math inline">\(D_{\alpha = 0.05}\)</span> :</p>
<ul>
<li><p>Si <span class="math inline">\(D = D_{\alpha \text{ = 0,05}}\)</span>, la distribution est aléatoire.</p></li>
<li><p>Si <span class="math inline">\(D &lt; D_{\alpha \text{ = 0,05}}\)</span>, la distribution est dispersée.</p></li>
<li><p>Si <span class="math inline">\(D &gt; D_{\alpha \text{ = 0,05}}\)</span>, la distribution est concentrée. Plus la valeur de <span class="math inline">\(D\)</span> est élevée, plus la distribution spatiale du semis de points est concentrée.</p></li>
</ul>
</li>
</ol>
<p><span id="eq-DValeurKS"><span class="math display">\[
D = \text{max}\lvert poi_{cumulé} - pti_{cumulé} \rvert
\tag{3.27}\]</span></span></p>
<p><span id="eq-DValeurKSCritique"><span class="math display">\[
D_{\alpha = \text{0,05}}= \frac{\text{1,36}}{\sqrt{m}}\text{ avec }
\tag{3.28}\]</span></span></p>
<p><span class="math inline">\(m\)</span> étant le nombre total de quadrats; <span class="math inline">\(poi_{cumulé}\)</span> et <span class="math inline">\(pti_{cumulé}\)</span>, les proportions cumulées observées et théoriques.</p>
<p>Appliquons cette démarche du test de Kolmogorov-Smirnov aux deux distributions de la <a href="#fig-FormeQuadratsExemple">figure&nbsp;<span>3.13</span></a>&nbsp;:</p>
<ul>
<li><span class="math inline">\(D_{\alpha = \text{0,05}}= \frac{\text{1,36}}{\sqrt{36}}=\text{0,210}\)</span></li>
<li>pour la situation A, <span class="math inline">\(D = \text{0,133}\)</span>, donc <span class="math inline">\(D &lt; D_{\alpha = \text{0,05}}\)</span>, alors la distribution est significativement dispersée.</li>
<li>pour la situation B, <span class="math inline">\(D = \text{0,439}\)</span>, donc <span class="math inline">\(D &gt; D_{\alpha = \text{0,05}}\)</span>, alors la distribution est significativement concentrée.</li>
</ul>
<p><strong>Test statistique du khi-deux</strong></p>
<p>Ce test se décompose en quatre étapes&nbsp;:</p>
<ol type="1">
<li><p>Formuler l’hypothèse nulle stipulant que la distribution des fréquences observées dans les quadrats suit une distribution de Poisson (<span class="math inline">\(H_0\)</span>).</p></li>
<li><p>Calculer le khi-deux (<a href="#eq-KhiDeux">équation&nbsp;<span>3.29</span></a>).</p></li>
<li><p>Comparer la valeur du khi-deux obtenue avec celle du khi-deux théorique (<span class="math inline">\(\chi^2_{\alpha,dl}\)</span>) avec <span class="math inline">\(k-1\)</span> degrés de liberté (<span class="math inline">\(dl\)</span>) et un seuil de signification <span class="math inline">\(\alpha\)</span> (0,05 par exemple).</p></li>
<li><p>Si <span class="math inline">\(\chi^2 &gt; \chi^2_{\alpha,dl}\)</span>, alors l’hypothèse nulle est rejetée.</p></li>
</ol>
<p><span id="eq-KhiDeux"><span class="math display">\[
\chi^2 = \sum_{i=1}^k \frac{(O_i - E_i)^2}{E_i}\text{ avec }
\tag{3.29}\]</span></span></p>
<p><span class="math inline">\(O_i\)</span> et <span class="math inline">\(E_i\)</span> étant respectivement les fréquences observée et attendue pour <span class="math inline">\(i\)</span> (quadrat avec 0 point, 1, 2, etc.).</p>
<p>Pour les deux situations, le khi-deux calculé est supérieur au khi-deux théorique avec un seuil <span class="math inline">\(\alpha\)</span> de 0,001 et 35&nbsp;degrés de liberté (paramètre <code>df</code> dans la fonction <code>qchisq</code> pour <em>degrees of freedom</em>). Par conséquent, les deux distributions ne sont pas aléatoires.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.95</span>,  df<span class="op">=</span><span class="fl">35</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 49.802</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.99</span>,  df<span class="op">=</span><span class="fl">35</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 57.342</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.999</span>,  df<span class="op">=</span><span class="fl">35</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66.619</code></pre>
</div>
</div>
<div class="bloc_attention">
<div class="bloc_attention-header">
<div class="bloc_attention-icon">

</div>
<p><strong>Loi de Poisson&nbsp;: pas de panique!</strong></p>
</div>
<div class="bloc_attention-body">
<p>Vous n’êtes pas familier avec la loi de probabilité de Poisson et le test du khi-deux, retenez simplement la démarche générale, nous utilisons des fonctions qui vont vous faciliter la vie dans R!</p>
</div>
</div>
</section><section id="sec-03254" class="level4" data-number="3.3.2.4"><h4 data-number="3.3.2.4" class="anchored" data-anchor-id="sec-03254">
<span class="header-section-number">3.3.2.4</span> Mise en œuvre dans R</h4>
<p>Le code suivant permet de déterminer la superficie optimale des quadrats en fonction du nombre de points (méfaits pour l’année 2020) et de la superficie de l’espace d’étude.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/">spatstat</a></span><span class="op">)</span></span>
<span><span class="co">## Taille des quadrats</span></span>
<span><span class="co"># Nombre de points</span></span>
<span><span class="va">npoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span></span>
<span><span class="co"># Superficie de l'espace d'étude</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Superficie du quadrat (équation 3.24)</span></span>
<span><span class="va">Sq</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">S</span><span class="op">)</span> <span class="op">/</span> <span class="va">npoints</span></span>
<span><span class="co"># Longueur du carré et du côté de l'hexagone régulier (équation 3.25)</span></span>
<span><span class="va">lq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Sq</span><span class="op">)</span></span>
<span><span class="va">la</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">Sq</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Trouver la longueur du côté du carré dans lequel est compris l'hexagone </span></span>
<span><span class="va">cellsizeHex</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Sq</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Nombre de points ="</span>, <span class="va">npoints</span>,</span>
<span>    <span class="st">"\nSuperficie (éq. 3.24) ="</span>, <span class="va">Sq</span>,</span>
<span>    <span class="st">"\nLongueur du côté du carré (éq. 3.25) ="</span>, <span class="va">lq</span>, </span>
<span>    <span class="st">"\nLongueur du côté du l'hexagone (éq. 3.25) ="</span>, <span class="va">la</span>,</span>
<span>    <span class="st">"\nLongueur du côté du carré dans lequel est compris l'hexagone ="</span>, <span class="va">cellsizeHex</span>, <span class="st">"\n"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre de points = 383 
Superficie (éq. 3.24) = 1913098 
Longueur du côté du carré (éq. 3.25) = 1383.148 
Longueur du côté du l'hexagone (éq. 3.25) = 858.1093 
Longueur du côté du carré dans lequel est compris l'hexagone = 1486.289 </code></pre>
</div>
</div>
<p>Nous pouvons ensuite créer deux couches avec des quadrats carrés et hexagonaux avec la fonction <code>st_make_grid</code> du <em>package</em> <code>sf</code>. Repérez le paramètre <code>square</code> dans la fonction <code>st_make_grid</code>&nbsp;: écrivez <code>square = TRUE</code> pour obtenir des carrés et <code>square = FALSE</code> pour des hexagones réguliers.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Création des quadrats</span></span>
<span><span class="co">#Géométrie pour l'espace d'étude</span></span>
<span><span class="va">EspaceEtude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Création des carrés</span></span>
<span><span class="va">Carres.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html">st_make_grid</a></span><span class="op">(</span><span class="va">EspaceEtude</span>, </span>
<span>                     <span class="va">lq</span>,  </span>
<span>                     crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span>,</span>
<span>                     what  <span class="op">=</span> <span class="st">"polygons"</span>,</span>
<span>                     square <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Création des hexagones</span></span>
<span><span class="va">Hexagones.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html">st_make_grid</a></span><span class="op">(</span><span class="va">EspaceEtude</span>, </span>
<span>                     <span class="va">cellsizeHex</span>,  </span>
<span>                     crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span>,</span>
<span>                     what  <span class="op">=</span> <span class="st">"polygons"</span>,</span>
<span>                     square <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carres.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>idCarre <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">)</span><span class="op">)</span>, <span class="va">Carres.sf</span><span class="op">)</span></span>
<span><span class="va">Hexagones.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html">st_sf</a></span><span class="op">(</span>idHex <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">Hexagones.sf</span><span class="op">)</span><span class="op">)</span>, <span class="va">Hexagones.sf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Superficie (éq. 3.24) ="</span>, <span class="va">Sq</span>,</span>
<span>    <span class="st">"\nVérifier la superficie des carrés et des hexagones"</span>,</span>
<span>    <span class="st">"\nSuperficie des carrés ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nSuperficie des hexagones ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_area</a></span><span class="op">(</span><span class="va">Hexagones.sf</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="st">"Les superficies sont bien égales!\n"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Superficie (éq. 3.24) = 1913098 
Vérifier la superficie des carrés et des hexagones 
Superficie des carrés = 1913098 
Superficie des hexagones = 1913098 Les superficies sont bien égales!</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Visualisation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Hexagones.sf</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"green"</span>, size<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La figure ci-dessus permet de constater que certains carrés et hexagones n’intersectent pas l’espace d’étude. Par conséquent, nous les supprimons puis calculons le nombre de points par carré et par hexagone.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Suppression des carrés qui n'intersectent pas les quatre arrondissements</span></span>
<span><span class="va">RequeteSpatiale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">Carres.sf</span>, </span>
<span>                                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carres.sf</span><span class="op">$</span><span class="va">Intersect</span> <span class="op">&lt;-</span> <span class="va">RequeteSpatiale</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">Carres.sf</span> <span class="op">&lt;-</span> <span class="va">Carres.sf</span><span class="op">[</span><span class="va">Carres.sf</span><span class="op">$</span><span class="va">Intersect</span><span class="op">==</span> <span class="cn">TRUE</span>, <span class="op">]</span></span>
<span><span class="co">## Suppression des hexagones qui n'intersectent pas les quatre arrondissements</span></span>
<span><span class="va">RequeteSpatiale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">Hexagones.sf</span>, </span>
<span>                                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html">st_union</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Hexagones.sf</span><span class="op">$</span><span class="va">Intersect</span> <span class="op">&lt;-</span> <span class="va">RequeteSpatiale</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">Hexagones.sf</span> <span class="op">&lt;-</span> <span class="va">Hexagones.sf</span><span class="op">[</span><span class="va">Hexagones.sf</span><span class="op">$</span><span class="va">Intersect</span><span class="op">==</span> <span class="cn">TRUE</span>, <span class="op">]</span></span>
<span><span class="co">## Jointure spatiale : compter le nombre de méfaits de 2020 dans les carrés et les hexagones</span></span>
<span><span class="va">Carres.sf</span><span class="op">$</span><span class="va">Mefaits2020</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">Carres.sf</span>, <span class="va">M2020</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Hexagones.sf</span><span class="op">$</span><span class="va">Mefaits2020</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">Hexagones.sf</span>, <span class="va">M2020</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Tableau de fréquences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">$</span><span class="va">Mefaits2020</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1   2   3   4   5   6   7   8  10  11  13  21  38  41  64 
172  25   6   3   8   1   3   4   3   2   3   1   1   1   1   1 </code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Hexagones.sf</span><span class="op">$</span><span class="va">Mefaits2020</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1   2   3   4   5   6   7   8   9  15  17  19  20  40  48 
173  23   5   5   3   5   6   1   3   1   2   1   1   1   1   2 </code></pre>
</div>
</div>
<p>Visualisons les résultats à la <a href="#fig-fig2PointsCarresHex">figure&nbsp;<span>3.14</span></a>. Il y a clairement une tendance à la concentration puisque de nombreux quadrats ne contiennent aucun point.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Visualisation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="va">Carte1</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Carres.sf</span>, <span class="va">Mefaits2020</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"gray90"</span>, border.col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Carres.sf</span>, <span class="va">Mefaits2020</span><span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"Mefaits2020"</span>, style<span class="op">=</span><span class="st">"cont"</span>, title<span class="op">=</span><span class="st">"Nombre"</span>, </span>
<span>                  border.col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">=</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Hexagones.sf</span>, <span class="va">Mefaits2020</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"gray90"</span>, border.col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Hexagones.sf</span>, <span class="va">Mefaits2020</span><span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"Mefaits2020"</span>, style<span class="op">=</span><span class="st">"cont"</span>, title<span class="op">=</span><span class="st">"Nombre"</span>,</span>
<span>                  border.col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig2PointsCarresHex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-fig2PointsCarresHex-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.14: Nombre de méfaits dans les deux géométries de quadrats</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons maintenant construire le tableau de fréquences et mettre en œuvre les différents tests statistiques. Le code ci-dessous génère le tableau de fréquences et applique <strong>le test de Kolmogorov-Smirnov</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Construction du tableau de fréquences</span></span>
<span><span class="va">TabFreq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">$</span><span class="va">Mefaits2020</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Npoints"</span>,<span class="st">"Fo"</span><span class="op">)</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Calcul pour les fréquences observées (fo)</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo.pro</span> <span class="op">&lt;-</span> <span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo</span><span class="op">)</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo.proCum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo.pro</span><span class="op">)</span></span>
<span><span class="co"># Calcul pour les fréquences théoriques</span></span>
<span><span class="va">npoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span><span class="op">*</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo</span><span class="op">)</span></span>
<span><span class="va">nquadrats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo</span><span class="op">)</span></span>
<span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="va">npoints</span> <span class="op">/</span> <span class="va">nquadrats</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Ft.pro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span>, lambda<span class="op">=</span> <span class="va">Lambda</span><span class="op">)</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Ft.proCum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">ppois</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span>, lambda<span class="op">=</span> <span class="va">Lambda</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Ft</span> <span class="op">&lt;-</span> <span class="va">TabFreq</span><span class="op">$</span><span class="va">Ft.pro</span> <span class="op">*</span> <span class="va">TabFreq</span><span class="op">$</span><span class="va">Npoints</span></span>
<span><span class="co"># Différences absolues entre les fréquences observées et théoriques cumulées</span></span>
<span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Difffoft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Fo.proCum</span> <span class="op">-</span> <span class="va">TabFreq</span><span class="op">$</span><span class="va">Ft.proCum</span><span class="op">)</span></span>
<span><span class="co">#calcul de D et Da</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">TabFreq</span><span class="op">$</span><span class="va">Difffoft</span><span class="op">)</span></span>
<span><span class="va">Da</span> <span class="op">&lt;-</span> <span class="fl">1.36</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">nquadrats</span><span class="op">)</span> <span class="co"># avec p à 0,05</span></span>
<span><span class="co">## Diagnostic</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">D</span><span class="op">&gt;</span><span class="va">Da</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"D ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">D</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" et Da ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Da</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>      <span class="st">"\nD &gt; Da avec p =0,05, alors la distribution tend vers la concentration."</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"D ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">D</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">" et Da ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Da</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>      <span class="st">"\nD &lt; Da avec p =0,05, alors la distribution tend vers la dispersion."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>D = 0.536  et Da = 0.089 
D &gt; Da avec p =0,05, alors la distribution tend vers la concentration.</code></pre>
</div>
</div>
<p>Le <em>package</em> <code>spatstat</code> permet de réaliser différents tests avec la fonction <code>quadrat.test</code>. Pour ce faire, il faut préalablement convertir les données dans les formats utilisés par ce <em>package</em> (<code>ppp</code>, <code>owin</code> et <code>tess</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Conversion des points au format ppp</span></span>
<span><span class="va">M2020.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">M2020</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                 window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.owin.html">as.owin</a></span><span class="op">(</span><span class="va">Arrondissements</span><span class="op">)</span>, </span>
<span>                 check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## Conversion des quadrats carrés ou hexagonaux en objet owin</span></span>
<span><span class="va">quadrats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">Carres.sf</span><span class="op">)</span>, <span class="st">"Spatial"</span><span class="op">)</span> </span>
<span><span class="va">FenetresC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">quadrats</span><span class="op">@</span><span class="va">polygons</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">coords</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">Polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coords</span></span>
<span>  <span class="va">coords</span><span class="op">&lt;-</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/owin.html">owin</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">coords</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">quadrats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">Hexagones.sf</span><span class="op">)</span>, <span class="st">"Spatial"</span><span class="op">)</span> </span>
<span><span class="va">FenetresH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">quadrats</span><span class="op">@</span><span class="va">polygons</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">coords</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">Polygons</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coords</span></span>
<span>  <span class="va">coords</span><span class="op">&lt;-</span><span class="va">coords</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/owin.html">owin</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">coords</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">## Ces fenêtres sont ensuite converties en un objet tess (tesselation)</span></span>
<span><span class="va">TessalationC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.tess.html">as.tess</a></span><span class="op">(</span><span class="va">FenetresC</span><span class="op">)</span></span>
<span><span class="va">TessalationH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.tess.html">as.tess</a></span><span class="op">(</span><span class="va">FenetresH</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons calculer différents tests avec la fonction <code>quadrat.test</code>. Dans un premier temps, nous vérifions si <strong>la distribution est dispersée</strong> avec la méthode Monte-Carlo et 999&nbsp;permutations (<code>alternative ="regular"</code>). Que ce soit avec les quadrats carrés ou hexagonaux, la valeur de <em>p</em> est égale à 0. Cela signifie que nous sommes 100&nbsp;% certains que la distribution n’est pas dispersée.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Réalisation des différents tests du khi-deux</span></span>
<span><span class="co"># test pour une distribution dispersée (Carrés)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Test pour une distribution dispersée avec les quadrats carrés"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test pour une distribution dispersée avec les quadrats carrés</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/quadrat.test.html">quadrat.test</a></span><span class="op">(</span><span class="va">M2020.ppp</span>, tess <span class="op">=</span> <span class="va">TessalationC</span>,</span>
<span>             method <span class="op">=</span> <span class="st">"MonteCarlo"</span>, nsim <span class="op">=</span> <span class="fl">999</span>,</span>
<span>             alternative <span class="op">=</span><span class="st">"regular"</span><span class="op">)</span>  <span class="co"># dispersée</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Conditional Monte Carlo test of CSR using quadrat counts
    Test statistic: Pearson X2 statistic

data:  M2020.ppp
X2 = 5212.2, p-value = 1
alternative hypothesis: regular

Quadrats: 235 tiles (irregular windows)</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Test pour une distribution dispersée avec les quadrats hexagonaux"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test pour une distribution dispersée avec les quadrats hexagonaux</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/quadrat.test.html">quadrat.test</a></span><span class="op">(</span><span class="va">M2020.ppp</span>, tess <span class="op">=</span> <span class="va">TessalationH</span>,</span>
<span>             method <span class="op">=</span> <span class="st">"MonteCarlo"</span>, nsim <span class="op">=</span> <span class="fl">999</span>,</span>
<span>             alternative <span class="op">=</span><span class="st">"regular"</span><span class="op">)</span>  <span class="co"># dispersée</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Conditional Monte Carlo test of CSR using quadrat counts
    Test statistic: Pearson X2 statistic

data:  M2020.ppp
X2 = 4792.3, p-value = 1
alternative hypothesis: regular

Quadrats: 233 tiles (irregular windows)</code></pre>
</div>
</div>
<p>Dans un second temps, nous vérifions si <strong>la distribution est concentrée</strong>, toujours avec la méthode Monte-Carlo et 999&nbsp;permutations (<code>alternative ="clustered"</code>). Que ce soit avec les quadrats carrés ou hexagonaux, la valeur de <em>p</em> est égale à 0,001. Cela signifie qu’il y a moins de 1&nbsp;% de chances que la distribution concentrée soit due au hasard.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># test pour une distribution concentrée</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Test pour une distribution concentrée avec les quadrats carrés"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test pour une distribution concentrée avec les quadrats carrés</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/quadrat.test.html">quadrat.test</a></span><span class="op">(</span><span class="va">M2020.ppp</span>, tess <span class="op">=</span> <span class="va">TessalationC</span>,</span>
<span>             method <span class="op">=</span> <span class="st">"MonteCarlo"</span>, nsim <span class="op">=</span> <span class="fl">999</span>,</span>
<span>             alternative <span class="op">=</span><span class="st">"clustered"</span><span class="op">)</span> <span class="co"># concentrée</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Conditional Monte Carlo test of CSR using quadrat counts
    Test statistic: Pearson X2 statistic

data:  M2020.ppp
X2 = 5212.2, p-value = 0.001
alternative hypothesis: clustered

Quadrats: 235 tiles (irregular windows)</code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Test pour une distribution concentrée avec les quadrats hexagonaux"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test pour une distribution concentrée avec les quadrats hexagonaux</code></pre>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/quadrat.test.html">quadrat.test</a></span><span class="op">(</span><span class="va">M2020.ppp</span>, tess <span class="op">=</span> <span class="va">TessalationH</span>,</span>
<span>             method <span class="op">=</span> <span class="st">"MonteCarlo"</span>, nsim <span class="op">=</span> <span class="fl">999</span>,</span>
<span>             alternative <span class="op">=</span><span class="st">"clustered"</span><span class="op">)</span> <span class="co"># concentrée</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Conditional Monte Carlo test of CSR using quadrat counts
    Test statistic: Pearson X2 statistic

data:  M2020.ppp
X2 = 4792.3, p-value = 0.001
alternative hypothesis: clustered

Quadrats: 233 tiles (irregular windows)</code></pre>
</div>
</div>
</section></section></section><section id="sec-034" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="sec-034">
<span class="header-section-number">3.4</span> Cartographie de la densité des points</h2>
<p>Pour repérer les concentrations d’un semis de points dans une région, il faut cartographier la densité des points dans une maille soit irrégulière, soit régulière.</p>
<section id="sec-0341" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="sec-0341">
<span class="header-section-number">3.4.1</span> Cartographie de la densité dans une maille irrégulière</h3>
<p>Une maille irrégulière est habituellement un découpage administratif comme les municipalités régionales de comté (MRC) du Québec ou les arrondissements d’une ville.</p>
<p>À la <a href="#fig-figDensiteIrreguliere">figure&nbsp;<span>3.15</span></a>, nous avons compté le nombre de méfaits par secteur de recensement pour l’année 2021, puis calculé la densité, soit le nombre de méfaits pour 1000&nbsp;habitants. Les cercles proportionnels permettent ainsi de repérer les secteurs comprenant le plus de méfaits. Comme la population totale varie d’un SR à l’autre, il est préférable de cartographier la densité, soit le nombre de méfaits pour 1000&nbsp;habitants. Notez que pour d’autres jeux de données, il serait plus judicieux d’utiliser la superficie comme dénominateur pour calculer la densité (par exemple, le nombre d’arbres au kilomètre carré ou à l’hectare).</p>
<p>En quelques lignes de code, il est très facile de calculer et de cartographier la densité dans un maillage irrégulier.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Secteurs de recensement (SR) de la ville de Sherbrooke en 2021</span></span>
<span><span class="va">SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/Recen2021Sherbrooke.gpkg"</span>,</span>
<span>              layer <span class="op">=</span> <span class="st">"DR_SherbSRDonnees2021"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Sélection des méfaits pour l'année 2021</span></span>
<span><span class="va">Incidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/IncidentsSecuritePublique.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">M2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Incidents</span>, <span class="va">DESCRIPTIO</span> <span class="op">==</span> <span class="st">"Méfait"</span> <span class="op">&amp;</span> <span class="va">ANNEE</span><span class="op">==</span><span class="fl">2021</span><span class="op">)</span></span>
<span><span class="co">## Nous nous assurons que les deux couches ont la même projection cartographique</span></span>
<span><span class="va">SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">SR</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">M2021</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Calcul du nombre d'incidents par SR </span></span>
<span><span class="va">SR</span><span class="op">$</span><span class="va">Mefaits2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">SR</span>, <span class="va">M2021</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Calcul du nombre de méfaits pour 1000 habitants</span></span>
<span><span class="va">SR</span><span class="op">$</span><span class="va">DensiteM21Hab</span> <span class="op">&lt;-</span> <span class="va">SR</span><span class="op">$</span><span class="va">Mefaits2021</span> <span class="op">/</span> <span class="op">(</span><span class="va">SR</span><span class="op">$</span><span class="va">SRpop_2021</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">## Cartographie</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">SR</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"Mefaits2021"</span>, style<span class="op">=</span><span class="st">"pretty"</span>, </span>
<span>              title<span class="op">=</span><span class="st">"Nombre pour 1000 habitants"</span>,</span>
<span>              legend.format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text.separator <span class="op">=</span> <span class="st">"à"</span><span class="op">)</span>,</span>
<span>              border.col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_bubbles</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"DensiteM21Hab"</span>, border.col <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                     col <span class="op">=</span> <span class="st">"aquamarine3"</span>, title.size <span class="op">=</span> <span class="st">"Nombre"</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span>text.size <span class="op">=</span> <span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figDensiteIrreguliere" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-figDensiteIrreguliere-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.15: Densité des méfaits par secteur de recensement, ville de Sherbrooke, 2021</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-0342" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="sec-0342">
<span class="header-section-number">3.4.2</span> Cartographie de la densité dans une maille régulière</h3>
<section id="sec-03421" class="level4" data-number="3.4.2.1"><h4 data-number="3.4.2.1" class="anchored" data-anchor-id="sec-03421">
<span class="header-section-number">3.4.2.1</span> Notion de processus spatial</h4>
<p>Lorsque nous analysons des évènements ayant eu lieu dans un espace donné, nous pouvons considérer que ces évènements résultent d’un processus spatial que nous ne pouvons pas observer. Ce processus spatial est caractérisé par des points chauds (endroits où des évènements se produisent souvent) et des points froids (endroits où des évènements se produisent rarement). Si nous collectons suffisamment d’évènements (observations), alors leur densité devrait nous renseigner sur ce processus spatial. Puisqu’une image vaut mille mots, examinons un exemple d’un processus spatial à la <a href="#fig-figExempleProcSpat">figure&nbsp;<span>3.16</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figExempleProcSpat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-figExempleProcSpat-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.16: Exemple d’un processus spatial</figcaption></figure>
</div>
</div>
</div>
<p>Imaginons que ce processus spatial représente le niveau de risque de se faire attaquer par un écureuil dans un parc urbain délimité ici par les limites de la figure. Dans la réalité, nous ne pouvons pas mesurer directement ce phénomène, mais nous disposons d’un registre des attaques d’écureuils qui ont été enregistrées et spatialisées (<a href="#fig-figExempleProcSpat2">figure&nbsp;<span>3.17</span></a>). Bien entendu, ces données sont fictives! Dans un langage plus technique, il est dit que <strong>les évènements sont des réalisations du processus spatial</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.random/man/rpoint.html">rpoint</a></span><span class="op">(</span><span class="fl">1500</span>,<span class="va">dens1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pts</span>, main <span class="op">=</span> <span class="st">"Attaques d'écureuils enregistrées"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-figExempleProcSpat2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-figExempleProcSpat2-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.17: Réalisation du processus spatial</figcaption></figure>
</div>
</div>
</div>
<p>Puisque nous disposons d’un grand nombre d’observations, nous pouvons reconstruire le processus spatial qui produit les évènements en appliquant la méthode d’analyse de densité dans une maille régulière (<a href="#fig-figExempleProcSpat3">figure&nbsp;<span>3.18</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figExempleProcSpat3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-figExempleProcSpat3-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.18: Reconstruction du processus spatial</figcaption></figure>
</div>
</div>
</div>
<p>La qualité d’estimation du processus initial dépend ainsi directement du nombre d’évènements dont nous disposons (<a href="#fig-figExempleProcSpat3">figure&nbsp;<span>3.18</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-figExempleProcSpat4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-figExempleProcSpat4-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.19: Reconstruction du processus spatial</figcaption></figure>
</div>
</div>
</div>
<p>Une fois que nous sommes en mesure de recréer le processus spatial, nous pouvons en apprendre plus sur le phénomène et ses causes. Par exemple, est-ce que les secteurs du parc avec les plus grandes concentrations d’accidents sont aussi ceux dans lesquels sont localisés des jeux pour enfants?</p>
</section><section id="sec-03422" class="level4" data-number="3.4.2.2"><h4 data-number="3.4.2.2" class="anchored" data-anchor-id="sec-03422">
<span class="header-section-number">3.4.2.2</span> Description de la méthode KDE</h4>
<p>Le principe de base d’une cartographie de la densité dans une maille régulière –&nbsp;appelée aussi carte de chaleur ou estimation de la densité par noyau (<em>kernel density estimation</em> – KDE, en anglais)&nbsp;– est relativement simple et se décompose en trois étapes&nbsp;:</p>
<ol type="1">
<li>Juxtaposer une grille de cellules sur l’espace d’étude, soit les pixels d’une image de <em>n</em> mètres de côté (par exemple, 50&nbsp;mètres).</li>
<li>Pour chaque pixel, juxtaposer une zone de recherche de <em>n</em> mètres de rayon (1000 mètres par exemple) et calculer le nombre de points présents dans cette zone de recherche.</li>
<li>Calculer la densité à partir d’une fonction simple (appelée habituellement fonction uniforme) ou d’une fonction de densité (<em>kernel</em>). Pour une fonction simple, nous divisons simplement le nombre de points présents dans la zone de recherche par la superficie de la zone, soit <span class="math inline">\(πr^2\)</span>; cette approche est toutefois peu recommandée puisqu’elle accorde la même pondération à chaque point situé de la zone d’influence! En utilisant une fonction de densité (<em>kernel</em>) (<a href="#eq-KernelDensity">équation&nbsp;<span>3.30</span></a>), nous accordons une pondération à chacun des points compris dans la zone de recherche : plus le point est proche du centre de la cellule, plus son poids est important dans l’estimation de la densité.</li>
</ol>
<p><span id="eq-KernelDensity"><span class="math display">\[
\lambda(s) = \sum_{i=1}^n \frac{1}{\pi r^2} k\biggl(\frac{d_{si}}{r}\biggl)\text{ avec }
\tag{3.30}\]</span></span></p>
<ul>
<li>
<span class="math inline">\(\lambda(s)\)</span>, estimation de la densité à la localisation <span class="math inline">\(s\)</span>.</li>
<li>
<span class="math inline">\(r\)</span>, rayon de la zone de recherche.</li>
<li>
<span class="math inline">\(d_{is}\)</span>, distance entre la localisation <span class="math inline">\(s\)</span> et le point <span class="math inline">\(i\)</span>.</li>
<li>
<span class="math inline">\(k\)</span>, fonction <em>kernel</em> définissant la pondération à accorder au ratio <span class="math inline">\(\frac{d_{si}}{r}\)</span> quand <span class="math inline">\(0 &lt; d_{si} \leq r\)</span>. Si <span class="math inline">\(d_{si} &gt; r\)</span>, alors <span class="math inline">\(k(d_{si}/r) = 0\)</span>.</li>
</ul>
<p>Il existe différentes fonctions <em>kernel</em> pour obtenir les pondérations des points. Telle qu’illustrée à la <a href="#fig-IllustationKernel">figure&nbsp;<span>3.20</span></a>, l’idée générale est que plus la distance entre la localisation et le point augmente (<span class="math inline">\(d_{si}\)</span>), plus la pondération <span class="math inline">\(k(d_{si}/r)\)</span> de l’équation <a href="#eq-KernelDensity">équation&nbsp;<span>3.30</span></a> est faible.</p>
<div id="fig-IllustationKernel" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/IlustratorKernel.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.20: Principe de la fonction <em>kernel</em> pour définir les pondérations des points voisins dans la zone d’influence</figcaption></figure>
</div>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Les différentes fonctions <em>kernel</em> d’estimation de la densité</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Pour une description des différentes fonctions <em>kernel</em>, <a href="https://fr.wikipedia.org/wiki/Noyau_(statistiques)">consultez le lien suivant</a>. Notez que l’outil <em>Carte de chaleur (estimation par noyau)</em> de QGIS inclut plusieurs fonctions <em>kernel</em> alors que l’outil <em>Kernel Density</em> d’ArcGIS&nbsp;Pro utilise uniquement la fonction quadratique. Finalement, la fonction <code>density.ppp</code> du <em>package</em> <code>spatstat</code> intègre quatre fonctions.</p>
<p><strong>Influence de la forme du noyau (fonction <em>kernel</em>)</strong></p>
<p>Excepté la fonction uniforme, la plupart des auteurs s’entendent sur le fait que le choix de fonctions <em>kernel</em> a relativement peu d’influence sur le résultat final comparativement au choix du rayon d’influence.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-TableauFonctionsKernel" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tableau&nbsp;3.4: Fonctions <em>kernel</em> disponibles selon différents logiciels</caption>
<thead><tr class="header">
<th style="text-align: right;">Fonction</th>
<th style="text-align: center;">QGis</th>
<th style="text-align: center;">ArcGIS Pro</th>
<th style="text-align: center;">CrimeStat</th>
<th style="text-align: center;">R (density.ppp)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Gaussienne</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: right;">Triangulaire</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">Quadratique</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: right;">Uniforme</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Cubique</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">Epanechnikov</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Exponentielle</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section><section id="sec-03423" class="level4" data-number="3.4.2.3"><h4 data-number="3.4.2.3" class="anchored" data-anchor-id="sec-03423">
<span class="header-section-number">3.4.2.3</span> Mise en œuvre de la KDE dans R</h4>
<p>Pour calculer la densité dans une maille régulière (KDE), vous pouvez utiliser deux <em>packages</em>&nbsp;:</p>
<ol type="1">
<li>
<code>SpatialKDE</code>, un <em>package</em> proposé récemment qui reprend le code de l’outil <em>Carte de chaleur (estimation par noyau)</em> de QGIS <span class="citation" data-cites="SpatialKDEPackage">(<a href="references.html#ref-SpatialKDEPackage" role="doc-biblioref">Caha 2023</a>)</span>. Vous obtiendrez donc les mêmes fonctionnalités et résultats qu’avec QGIS. Pour un exemple d’utilisation, consultez <a href="https://cran.r-project.org/web/packages/SpatialKDE/vignettes/SpatialKDE.html">cette vignette</a>.</li>
<li>
<code>spatstat</code>, soit le <em>package</em> le plus complet pour réaliser des analyses de répartition ponctuelle <span class="citation" data-cites="spatstatPackage baddeley2015spatial">(<a href="references.html#ref-spatstatPackage" role="doc-biblioref">Baddeley et Turner 2005</a>; <a href="references.html#ref-baddeley2015spatial" role="doc-biblioref">Baddeley, Rubak et Turner 2015</a>)</span>. Par conséquent, nous privilégions son utilisation dans les exemples ci-dessous.</li>
</ol>
<p>Afin d’expliquer comment réaliser une KDE dans R, nous utilisons les accidents survenus dans l’arrondissement des Nations de la ville de Sherbrooke. Notez que nous retenons uniquement cet arrondissement et non l’ensemble de la ville afin d’accélérer les temps de calculs.</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/">spatstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap">tmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/">terra</a></span><span class="op">)</span></span>
<span><span class="co">## Importation des données </span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/Arrondissements.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Incidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/chap03/IncidentsSecuritePublique.shp"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Arrondissements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">Arrondissements</span>, crs <span class="op">=</span> <span class="fl">3798</span><span class="op">)</span> </span>
<span><span class="va">Incidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">Incidents</span>, crs <span class="op">=</span> <span class="fl">3798</span><span class="op">)</span></span>
<span><span class="co">## Couche pour les accidents</span></span>
<span><span class="va">Accidents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">Incidents</span>, <span class="va">Incidents</span><span class="op">$</span><span class="va">DESCRIPTIO</span> <span class="op"><a href="https://rdrr.io/pkg/terra/man/match.html">%in%</a></span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Accident avec blessés"</span>, <span class="st">"Accident mortel"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Pour accélérer les calculs, nous retenons uniquement l'arrondissement des Nations</span></span>
<span><span class="co"># Couche pour l'arrondissement des Nations</span></span>
<span><span class="va">ArrDesNations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">Arrondissements</span>, <span class="va">NOM</span> <span class="op">==</span> <span class="st">"Arrondissement des Nations"</span><span class="op">)</span></span>
<span><span class="co"># Sélection des accidents localisés dans l'arrondissement des Nations</span></span>
<span><span class="va">RequeteSpatiale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">Accidents</span>, <span class="va">ArrDesNations</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Accidents</span><span class="op">$</span><span class="va">Nations</span> <span class="op">&lt;-</span> <span class="va">RequeteSpatiale</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">AccNations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">Accidents</span>, <span class="va">Accidents</span><span class="op">$</span><span class="va">Nations</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Une couche par année</span></span>
<span><span class="va">AccNations2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">AccNations</span>, <span class="va">AccNations</span><span class="op">$</span><span class="va">AN</span> <span class="op">==</span> <span class="fl">2019</span><span class="op">)</span></span>
<span><span class="va">AccNations2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">AccNations</span>, <span class="va">AccNations</span><span class="op">$</span><span class="va">AN</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">AccNations2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">AccNations</span>, <span class="va">AccNations</span><span class="op">$</span><span class="va">AN</span> <span class="op">==</span> <span class="fl">2021</span><span class="op">)</span></span>
<span><span class="va">AccNations2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html">subset</a></span><span class="op">(</span><span class="va">AccNations</span>, <span class="va">AccNations</span><span class="op">$</span><span class="va">AN</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous convertissons les points dans le format <code>ppp</code> utilisé par le <em>package</em> <code>spatstat</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Conversion des données sf dans le format de spatstat</span></span>
<span><span class="co"># la fonction as.owin est utilisée pour définir la fenêtre de travail</span></span>
<span><span class="va">fenetre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.owin.html">as.owin</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span></span>
<span><span class="co">## Conversion des points au format ppp pour les différentes années</span></span>
<span><span class="co"># 2019 </span></span>
<span><span class="va">AccN2019.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2019</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                    y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2019</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                    window <span class="op">=</span> <span class="va">fenetre</span>, check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># 2020 </span></span>
<span><span class="va">AccN2020.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                    y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                    window <span class="op">=</span> <span class="va">fenetre</span>, check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> </span>
<span><span class="co"># 2021 </span></span>
<span><span class="va">AccN2021.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2021</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                    y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2021</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                    window <span class="op">=</span> <span class="va">fenetre</span>, check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># 2022</span></span>
<span><span class="va">AccN2022.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2022</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                    y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">AccNations2022</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                    window <span class="op">=</span> <span class="va">fenetre</span>, check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Puis, il faut définir la taille des pixels et le rayon d’influence (<em>bandwidth</em> en anglais)&nbsp;:</p>
<ul>
<li><p>Plus la taille des pixels est réduite, plus la taille de l’image résultante est importante et les calculs longs à réaliser.</p></li>
<li><p>Le choix du rayon est aussi délicat. Avec un rayon trop petit, les résultats sont trop détaillés avec des valeurs très faibles. À l’inverse, un rayon trop grand a comme effet de lisser les résultats et de masquer des disparités locales.</p></li>
</ul>
<div class="bloc_astuce">
<div class="bloc_astuce-header">
<div class="bloc_astuce-icon">

</div>
<p><strong>Ratio entre la taille du pixel et la taille du rayon d’influence</strong></p>
</div>
<div class="bloc_astuce-body">
<p>Assurez-vous que la taille du pixel soit bien inférieure (au moins dix fois plus petite) à celle du rayon d’influence afin d’obtenir des résultats précis. À notre connaissance, il n’existe pas de règle pour optimiser la valeur ratio entre la taille du pixel et la taille du rayon d’influence.</p>
</div>
</div>
<p>Plusieurs algorithmes permettant de sélectionner la valeur optimale du rayon d’influence sont implémentés dans le <em>package</em> <code>spatstat</code> avec les fonctions <code>bw.diggle</code>, <code>bw.ppl</code>, <code>bw.scott</code> et <code>bw.CvL</code>. À la lecture des résultats ci-dessous, la valeur du rayon proposée par l’algorithme de Diggle semble bien trop petite et celle du critère de Cronie et van Lieshout bien trop grande. Le rayon optimal est certainement compris entre 700 et 750&nbsp;mètres. Par conséquent, nous retenons une taille de pixel de 50&nbsp;mètres et la valeur du rayon optimisée par la fonction <code>bw.ppl</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nDiggle :"</span>, <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.diggle.html">bw.diggle</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nMaximum de vraissemblance :"</span>, <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.ppl.html">bw.ppl</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nCritère de Scott 1 :"</span>, <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.scott.html">bw.scott</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    <span class="st">"\nCritère  de Scott 2 :"</span>, <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.scott.html">bw.scott</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    <span class="st">"\nCritère de Cronie et van Lieshout :"</span>, <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.CvL.html">bw.CvL</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Diggle : 124.196 
Maximum de vraissemblance : 494.5408 
Critère de Scott 1 : 971.3489 
Critère  de Scott 2 : 514.2688 
Critère de Cronie et van Lieshout : 1644.489</code></pre>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Taille des pixels et du rayon en mètres</span></span>
<span><span class="va">pixel_m</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">RayonOpt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/bw.ppl.html">bw.ppl</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-034221" class="level5" data-number="3.4.2.3.1"><h5 data-number="3.4.2.3.1" class="anchored" data-anchor-id="sec-034221">
<span class="header-section-number">3.4.2.3.1</span> Comparaison des fonctions <em>kernel</em>
</h5>
<p>Le paramètre <code>kernel</code> de la fonction <code>density.ppp</code> permet de sélectionner l’une des quatre fonctions <em>kernel</em> (<code>gaussian</code>, <code>quartic</code>, <code>epanechnikov</code> et <code>disc</code>). Pour la dernière, le même poids est attribué aux points compris dans le rayon d’influence; elle correspond ainsi à un <em>kernel</em> uniforme ou simple. Excepté ce dernier <em>kernel</em>, la <a href="#fig-CartoQuatreKernels">figure&nbsp;<span>3.21</span></a> démontre que les résultats sont très semblables d’un <em>kernel</em> à l’autre.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Calcul de la KDE avec différentes fonctions kernel</span></span>
<span><span class="co"># kernel gaussien</span></span>
<span><span class="va">kdeG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="va">RayonOpt</span>, eps<span class="op">=</span><span class="va">pixel_m</span>, kernel<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="co"># kernel quadratique</span></span>
<span><span class="va">kdeQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="va">RayonOpt</span>, eps<span class="op">=</span><span class="va">pixel_m</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="co"># kernel Epanechnikov</span></span>
<span><span class="va">kdeE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="va">RayonOpt</span>, eps<span class="op">=</span><span class="va">pixel_m</span>, kernel<span class="op">=</span><span class="st">"epanechnikov"</span><span class="op">)</span></span>
<span><span class="co"># kernel disc (uniforme ou simple)</span></span>
<span><span class="co"># le même poids est accordé à chaque point dans le rayon</span></span>
<span><span class="va">kdeD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="va">RayonOpt</span>, eps<span class="op">=</span><span class="va">pixel_m</span>, kernel<span class="op">=</span><span class="st">"disc"</span><span class="op">)</span></span>
<span><span class="co">## Conversion en raster </span></span>
<span><span class="co"># étant donné que les valeurs sont exprimées en nombre de points par m2,</span></span>
<span><span class="co"># nous les multiplions par 1 000 000 pour obtenir une densité au km2.</span></span>
<span><span class="va">RkdeG</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeG</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeQ</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeQ</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeE</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeE</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeD</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeD</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="co">## Projection cartographique</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeG</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeQ</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeD</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span><span class="co">## Visualisation des résultats</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="va">Carte1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeG</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"Gaussien"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeQ</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"Quadratique"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"Epanechnikov"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeD</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"Uniforme"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span>breaks  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span>, <span class="va">Carte3</span>, <span class="va">Carte4</span>,</span>
<span>             ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CartoQuatreKernels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CartoQuatreKernels-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.21: Comparaison des résultats de la KDE pour différents kernels</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-034222" class="level5" data-number="3.4.2.3.2"><h5 data-number="3.4.2.3.2" class="anchored" data-anchor-id="sec-034222">
<span class="header-section-number">3.4.2.3.2</span> Évaluation de l’impact du rayon d’influence</h5>
<p>Le code R permet de réaliser des KDE avec des rayons de 250, 500, 750 et 1000&nbsp;mètres. La <a href="#fig-CartoQuatreKernels">figure&nbsp;<span>3.21</span></a> démontre bien que plus le rayon est grand, plus la carte est lissée.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kdeQ250</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="fl">250</span>,  eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kdeQ500</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="fl">500</span>,  eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kdeQ750</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="fl">750</span>,  eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kdeQ1000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="fl">1000</span>, eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">RkdeQ250</span>  <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeQ250</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeQ500</span>  <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeQ500</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeQ750</span>  <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeQ750</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">RkdeQ1000</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kdeQ1000</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeQ250</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeQ500</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeQ750</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">RkdeQ1000</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span></span>
<span><span class="co">## Visualisation des résultats</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="va">Carte1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeQ250</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"r = 250 m"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeQ500</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"r = 500 m"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeQ750</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"r = 750 m"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">RkdeQ1000</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"r = 1000 m"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span>breaks  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span>, <span class="va">Carte3</span>, <span class="va">Carte4</span>,</span>
<span>             ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CartoDistKernels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CartoDistKernels-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.22: Comparaison des résultats de la KDE selon le rayon d’influence</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-034223" class="level5" data-number="3.4.2.3.3"><h5 data-number="3.4.2.3.3" class="anchored" data-anchor-id="sec-034223">
<span class="header-section-number">3.4.2.3.3</span> Comparaison entre différentes années</h5>
<p>Bien entendu, pour un même jeu de données, il est possible de représenter la densité pour différentes années (<a href="#fig-CartoTemporelleKernels">figure&nbsp;<span>3.23</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kde2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2019.ppp</span>, sigma<span class="op">=</span><span class="fl">500</span>, eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kde2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2020.ppp</span>, sigma<span class="op">=</span><span class="fl">500</span>, eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kde2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2021.ppp</span>, sigma<span class="op">=</span><span class="fl">500</span>, eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">kde2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/density.ppp.html">density.ppp</a></span><span class="op">(</span><span class="va">AccN2022.ppp</span>, sigma<span class="op">=</span><span class="fl">500</span>, eps<span class="op">=</span><span class="fl">50</span>, kernel<span class="op">=</span><span class="st">"quartic"</span><span class="op">)</span></span>
<span><span class="va">Rkde2019</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kde2019</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">Rkde2020</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kde2020</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">Rkde2021</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kde2020</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="va">Rkde2022</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">kde2021</span><span class="op">)</span><span class="op">*</span><span class="fl">1000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">Rkde2019</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">Rkde2020</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">Rkde2021</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">Rkde2022</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:3798"</span></span>
<span></span>
<span><span class="va">Carte1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Rkde2019</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"2019"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2019</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Rkde2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"2021"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2020</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Rkde2021</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"2022"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2021</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">Carte4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Rkde2022</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>style <span class="op">=</span> <span class="st">"cont"</span>, palette<span class="op">=</span><span class="st">"Reds"</span>, title <span class="op">=</span> <span class="st">"2023"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">AccNations2022</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_symbols.html">tm_dots</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">ArrDesNations</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html">tm_borders</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_scale_bar.html">tm_scale_bar</a></span><span class="op">(</span>breaks  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_arrange.html">tmap_arrange</a></span><span class="op">(</span><span class="va">Carte1</span>, <span class="va">Carte2</span>, <span class="va">Carte3</span>, <span class="va">Carte4</span>,</span>
<span>             ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CartoTemporelleKernels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-CartoTemporelleKernels-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.23: Comparaison des résultats de la KDE pour différentes années</figcaption></figure>
</div>
</div>
</div>
</section></section></section><section id="sec-0343" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="sec-0343">
<span class="header-section-number">3.4.3</span> Densité spatio-temporelle dans une maille régulière</h3>
<section id="sec-03431" class="level4" data-number="3.4.3.1"><h4 data-number="3.4.3.1" class="anchored" data-anchor-id="sec-03431">
<span class="header-section-number">3.4.3.1</span> Description de la méthode STKDE</h4>
<p>Dans les sections précédentes, nous avons vu que l’analyse de densité dans une maille régulière avec la méthode KDE consiste à répartir la masse des évènements étudiés dans un certain rayon d’influence (<em>bandwidth</em>) autour de chaque évènement selon une fonction décroissante (<em>kernel</em>).</p>
<p>Cette méthode peut être étendue assez facilement au contexte spatio-temporel. En effet, lorsque les évènements étudiés sont caractérisés par une date d’occurrence, il est possible de répartir leur masse à la fois dans l’espace et dans le temps. Plus exactement, il s’agit d’un kernel bivarié comprenant une <em>bandwidth</em> spatiale et une <em>bandwidth</em> temporelle. La densité locale est alors estimée avec le produit de la densité spatiale et de la densité temporelle de chaque évènement (<a href="#eq-STKDEDensity">équation&nbsp;<span>3.31</span></a>).</p>
<p><span id="eq-STKDEDensity"><span class="math display">\[
\lambda(s) = \sum_{i=1}^n \frac{1}{\pi bw_s^2 * bw_t} k\biggl(\frac{d_{si}}{bw_s}\biggl) k\biggl(\frac{t_{si}}{bw_t}\biggl)\text{ avec }
\tag{3.31}\]</span></span></p>
<ul>
<li>
<span class="math inline">\(bw_t\)</span> et <span class="math inline">\(bw_s\)</span> les rayons d’influence (<em>bandwidth</em>) temporel et spatial.</li>
<li>
<span class="math inline">\(t_{si}\)</span> et <span class="math inline">\(d_{si}\)</span> les distances temporelles et spatiales entre l’évènement <em>i</em> et un point dans l’espace et le temps <em>s</em>.</li>
<li>
<span class="math inline">\(k\)</span>, fonction <em>kernel</em>.</li>
</ul>
<p>La <a href="#fig-ExampleSTKDE">figure&nbsp;<span>3.24</span></a> illustre le principe de la STKDE (<em>Space-Time Kernel Density Estimatation</em>). Un évènement a lieu à un moment spécifique et en un lieu spécifique. Plus nous sommes proches de l’évènement dans le temps et dans l’espace, plus la densité est élevée. Hors du <em>bandwidth</em> dans le temps ou dans l’espace, la densité est nulle.</p>
<div id="fig-ExampleSTKDE" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/SpaceTimeDensity-01.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.24: Visualisation de la STKDE</figcaption></figure>
</div>
<p>Une représentation particulièrement efficace de la STKDE est une carte animée permettant de visualiser l’évolution spatiale de la densité dans le temps. À la <a href="#fig-ExampleSTKDEanim">figure&nbsp;<span>3.25</span></a>, nous visualisons la densité spatio-temporelle produite par deux évènements ayant eu lieu à des moments et des localisations différentes.</p>
<div id="fig-ExampleSTKDEanim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/animated_STKDE.gif" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.25: Visualisation animée de la STKDE</figcaption></figure>
</div>
<p>En résumé, la seule différence avec la KDE et la SKDE est que cette dernière nécessite de déterminer une <em>bandwidth</em> temporelle (en plus de la <em>bandwidth</em> spatiale).</p>
</section><section id="sec-03432" class="level4" data-number="3.4.3.2"><h4 data-number="3.4.3.2" class="anchored" data-anchor-id="sec-03432">
<span class="header-section-number">3.4.3.2</span> Mise en œuvre de la STKDE dans R</h4>
<p>Pour mettre en œuvre la STKDE sur les données de collisions de la ville de Sherbrooke, nous utilisons le <em>package</em> <code>sparr</code> <span class="citation" data-cites="Packagesparr">(<a href="references.html#ref-Packagesparr" role="doc-biblioref">Davies, Marshall et Hazelton 2018</a>)</span>. À la <a href="#fig-timeCollisions">figure&nbsp;<span>3.26</span></a>, nous visualisons aisément les périodes durant lesquelles les accidents ont été les plus nombreux.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/">spatstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-rust.r-universe.dev/gifski">gifski</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap">tmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tilmandavies.github.io/sparr/">sparr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">routes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">'data/chap01/shp/Segments_de_rue.shp'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">collisions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">'data/chap04/DataAccidentsSherb.shp'</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Reprojection dans le même système</span></span>
<span><span class="va">routes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">routes</span>, <span class="fl">2949</span><span class="op">)</span></span>
<span><span class="va">collisions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">collisions</span>, <span class="fl">2949</span><span class="op">)</span></span>
<span><span class="co">## Visualisation de la densité temporelle</span></span>
<span><span class="va">collisions</span><span class="op">$</span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span><span class="op">(</span><span class="va">collisions</span><span class="op">$</span><span class="va">DATEINCIDE</span><span class="op">)</span></span>
<span><span class="va">collisions</span><span class="op">$</span><span class="va">dt_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">collisions</span><span class="op">$</span><span class="va">dt</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">collisions</span><span class="op">$</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">collisions</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>bw <span class="op">=</span> <span class="st">'SJ'</span>, color <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span> <span class="st">"Densité"</span>, x <span class="op">=</span> <span class="st">"Date"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"6 months"</span>, date_labels <span class="op">=</span>  <span class="st">"%b %Y"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-timeCollisions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-MethodesRepartitionPonctuelle_files/figure-html/fig-timeCollisions-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.26: Distribution temporelle de la densité des accidents</figcaption></figure>
</div>
</div>
</div>
<p>Pour calculer la STKDE, nous devons déterminer les valeurs des deux <em>bandwidths</em>, réalisé ici avec une approche dite de validation croisée par maximum de vraisemblance.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Préparation des données de collisions</span></span>
<span><span class="va">fenetre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/as.owin.html">as.owin</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_buffer</a></span><span class="op">(</span><span class="va">collisions</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">XY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="va">collisions</span><span class="op">)</span></span>
<span><span class="va">collisions.ppp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/ppp.html">ppp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">XY</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                    y <span class="op">=</span> <span class="va">XY</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                    window <span class="op">=</span> <span class="va">fenetre</span>, check <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## Estimation des deux meilleures bandwidths</span></span>
<span><span class="va">scores_bw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tilmandavies.github.io/sparr/reference/LSCV.spattemp.html">LIK.spattemp</a></span><span class="op">(</span><span class="va">collisions.ppp</span>, </span>
<span>                          tt <span class="op">=</span> <span class="va">collisions</span><span class="op">$</span><span class="va">dt_num</span>,</span>
<span>                          tlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1100</span><span class="op">)</span>,</span>
<span>                          parallelise <span class="op">=</span> <span class="cn">NA</span>,verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scores_bw</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       h   lambda 
736.8287 147.4328 </code></pre>
</div>
</div>
<p>Les valeurs optimales obtenues avec l’approche dite de validation croisée par maximum de vraisemblance sont de 736&nbsp;mètres pour la <em>bandwidth</em> spatiale et 147&nbsp;jours pour la <em>bandwidth</em> temporelle. Cette dernière est vraisemblablement trop grande. Par conséquent, nous utilisons des <em>bandwidths</em> de 750&nbsp;mètres et 14&nbsp;jours. Notez que les valeurs de densité sont multipliées par 10&nbsp;000, car leur étalement dans l’espace et le temps conduit à des valeurs trop petites pour le <em>package</em> <code>tmap</code>. Les résultats sont présentés sous la forme d’une animation à la <a href="#fig-spacetimemapSherb">figure&nbsp;<span>3.27</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcul des valeurs de densités</span></span>
<span><span class="va">dens_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tilmandavies.github.io/sparr/reference/spattemp.density.html">spattemp.density</a></span><span class="op">(</span><span class="va">collisions.ppp</span>,</span>
<span>                              h <span class="op">=</span> <span class="fl">750</span>,</span>
<span>                              lambda <span class="op">=</span> <span class="fl">14</span>,</span>
<span>                              tt <span class="op">=</span> <span class="va">collisions</span><span class="op">$</span><span class="va">dt_num</span>,</span>
<span>                              tlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1100</span><span class="op">)</span>,</span>
<span>                              sres <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                              tres <span class="op">=</span> <span class="fl">150</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extraction des rasters à chaque période</span></span>
<span><span class="va">all_rasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">dens_vals</span><span class="op">$</span><span class="va">z</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">my_rast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10000</span> <span class="co"># petit ajustement pour la carto</span></span>
<span>  <span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html">values</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span></span>
<span>  <span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">vals</span><span class="op">)</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html">values</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">vals</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html">crs</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'epsg:32188'</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">my_rast</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">## Extraction des valeurs pour créer une échelle commune de couleur</span></span>
<span><span class="va">all_densities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">all_rasts</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html">values</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,size <span class="op">=</span> <span class="fl">100</span>,replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">color_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">all_densities</span>, n <span class="op">=</span> <span class="fl">10</span>, style <span class="op">=</span> <span class="st">"kmeans"</span><span class="op">)</span></span>
<span><span class="co">## Préparation des dates</span></span>
<span><span class="va">timestamps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dens_vals</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">collisions</span><span class="op">$</span><span class="va">dt</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html">days</a></span><span class="op">(</span><span class="va">timestamps</span><span class="op">)</span></span>
<span><span class="co">## Compilation des cartes</span></span>
<span><span class="va">all_maps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">time_frames</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">all_rasts</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_raster.html">tm_raster</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">color_breaks</span><span class="op">$</span><span class="va">brks</span>, palette <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_layout.html">tm_layout</a></span><span class="op">(</span>legend.show <span class="op">=</span> <span class="cn">FALSE</span>, frame <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="va">time_frames</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création d'une animation pour produire la carte animée</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tmap_animation.html">tmap_animation</a></span><span class="op">(</span><span class="va">all_maps</span>, filename <span class="op">=</span> <span class="st">"images/Chap03/animated_STKDE_sherbrooke.gif"</span>, </span>
<span>               width <span class="op">=</span> <span class="fl">500</span>, height <span class="op">=</span> <span class="fl">500</span>, dpi <span class="op">=</span> <span class="fl">150</span>, delay <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-spacetimemapSherb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/Chap03/animated_STKDE_sherbrooke.gif" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.27: Distribution spatio-temporelle de la densité des accidents</figcaption></figure>
</div>
</section></section></section><section id="sec-035" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="sec-035">
<span class="header-section-number">3.5</span> Quiz de révision du chapitre</h2>
<div id="Chap03" class="card">
<link type="text/javascript" src="libs/quizlib.1.0.1.min.js">
<script>var Quiz=function(a,b){this.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),this.unansweredQuestionText="Question sans réponse !",this.container=document.getElementById(a),this.questions=[],this.result=new QuizResult,this.answers=b;for(var c=0;c<this.container.children.length;c++)this.container.children[c].classList.contains(Quiz.Classes.QUESTION)&&this.questions.push(this.container.children[c]);if(this.answers.length!=this.questions.length)throw new Error("Number of answers does not match number of questions!")};Quiz.Classes=Object.freeze({QUESTION:"quizlib-question",QUESTION_TITLE:"quizlib-question-title",QUESTION_ANSWERS:"quizlib-question-answers",QUESTION_WARNING:"quizlib-question-warning",CORRECT:"quizlib-correct",INCORRECT:"quizlib-incorrect",TEMP:"quizlib-temp"}),Quiz.prototype.checkAnswers=function(a){void 0===a&&(a=!0);for(var b=[],c=[],d=0;d<this.questions.length;d++){var e=this.questions[d],f=this.answers[d],g=[];this.clearHighlights(e);for(var h,i=e.getElementsByClassName(Quiz.Classes.QUESTION_ANSWERS)[0].getElementsByTagName("input"),j=0;j<i.length;j++)h=i[j],"checkbox"===h.type||"radio"===h.type?h.checked&&g.push(h.value):""!==h.value&&g.push(h.value);1!=g.length||Array.isArray(f)?0===g.length&&b.push(e):g=g[0],c.push(Utils.compare(g,f))}if(0===b.length||!a)return this.result.setResults(c),!0;for(d=0;d<b.length;d++){var k=document.createElement("span");k.appendChild(document.createTextNode(this.unansweredQuestionText)),k.className=Quiz.Classes.QUESTION_WARNING,b[d].getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].appendChild(k)}return!1},Quiz.prototype.clearHighlights=function(a){for(var b=a.getElementsByClassName(Quiz.Classes.QUESTION_WARNING);b.length>0;)b[0].parentNode.removeChild(b[0]);var c,d=[a.getElementsByClassName(Quiz.Classes.CORRECT),a.getElementsByClassName(this.Classes.INCORRECT)];for(i=0;i<d.length;i++)for(;d[i].length>0;)c=d[i][0],c.classList.remove(Quiz.Classes.CORRECT),c.classList.remove(Quiz.Classes.INCORRECT);for(var e=a.getElementsByClassName(Quiz.Classes.TEMP);e.length>0;)e[0].parentNode.removeChild(e[0])},Quiz.prototype.highlightResults=function(a){for(var b,c=0;c<this.questions.length;c++)b=this.questions[c],b.getElementsByClassName(Quiz.Classes.QUESTION_TITLE)[0].classList.add(this.result.results[c]?Quiz.Classes.CORRECT:Quiz.Classes.INCORRECT),void 0!==a&&a(this,b,c,this.result.results[c])};var QuizResult=function(){this.results=[],this.totalQuestions=0,this.score=0,this.scorePercent=0,this.scorePercentFormatted=0};QuizResult.prototype.setResults=function(a){this.results=a,this.totalQuestions=this.results.length,this.score=0;for(var b=0;b<this.results.length;b++)this.results[b]&&this.score++;this.scorePercent=this.score/this.totalQuestions,this.scorePercentFormatted=Math.floor(100*this.scorePercent)};var Utils=function(){};Utils.compare=function(a,b){if(a.length!=b.length)return!1;if(Array.isArray(a)&&Array.isArray(b)){for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b};

function showResults(quiz) {
    // Check answers and continue if all questions have been answered
    if (quiz.checkAnswers()) {
        var quizScorePercent = quiz.result.scorePercentFormatted; // The unformatted percentage is a decimal in range 0 - 1
        var quizResultElement = document.getElementById('quiz-result');
        quizResultElement.style.display = 'block';
        document.getElementById('quiz-percent').innerHTML = quizScorePercent.toString();

        // Change background colour of results div according to score percent
        if (quizScorePercent > 75) quizResultElement.style.backgroundColor = '#4caf50';
        else if (quizScorePercent > 50) quizResultElement.style.backgroundColor = '#ffc107';
        else if (quizScorePercent > 25) quizResultElement.style.backgroundColor = '#ff9800';
        else if (quizScorePercent > 0) quizResultElement.style.backgroundColor = '#f44336';

        // Highlight questions according to whether they were correctly answered. The callback allows us to highlight/show the correct answer
        quiz.highlightResults(handleAnswers);
    }
}

/** Callback for Quiz.highlightResults. Highlights the correct answers of incorrectly answered questions
 * Parameters are: the quiz object, the question element, question number, correctly answered flag
 */
function handleAnswers(quiz, question, no, correct) {
    if (!correct) {
        var answers = question.getElementsByTagName('input');
        for (var i = 0; i < answers.length; i++) {
            if (answers[i].type === 'checkbox' || answers[i].type === 'radio'){
                // If the current input element is part of the correct answer, highlight it
                if (quiz.answers[no].indexOf(answers[i].value) > -1) {
                    answers[i].parentNode.classList.add(Quiz.Classes.CORRECT);
                }
            } else {
                // If the input is anything other than a checkbox or radio button, show the correct answer next to the element
                var correctAnswer = document.createElement('span');
                correctAnswer.classList.add(Quiz.Classes.CORRECT);
                correctAnswer.classList.add(Quiz.Classes.TEMP); // quiz.checkAnswers will automatically remove elements with the temp class
                correctAnswer.innerHTML = quiz.answers[no];
                correctAnswer.style.marginLeft = '10px';
                answers[i].parentNode.insertBefore(correctAnswer, answers[i].nextSibling);
            }
        }
    }
}

  var quizz_Chap03;
  window.onload = function() {
    quizz_Chap03 = new Quiz('Chap03', ['2','2',['1', '3', '4', '5'],['1', '2', '3'],'2',['2', '3', '4'],'2',['1', '2', '3', '5']]);
  };</script><link rel="stylesheet" type="text/css" src="css/quizlib.min.css">
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelle est la différence entre le centre point et le point central?
</div>
<div>
Relisez au besoin la <a href="#sec-03112">section&nbsp;<span>3.2.1.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Le centre moyen peut être pondéré contrairement au point central.</label>
</td>
<td>
<input type="radio" name="q1" value="1">
</td>
</tr>
<tr>
<td>
<label>Le point central est un point qui fait partie du semis de points initial.</label>
</td>
<td>
<input type="radio" name="q1" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Associer la distance standard à chacun des trois semis de points suivants :
</div>
<img src="images/quiz/Chap03_q02.png" alt="" style="width: 50%;display: block;margin-left: auto;margin-right: auto;margin-bottom: 0.5em;margin-top: 0.5em;"><div>
Relisez au besoin la <a href="#sec-0312">section&nbsp;<span>3.2.2</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>A = 219, B = 347, C = 685</label>
</td>
<td>
<input type="radio" name="q2" value="1">
</td>
</tr>
<tr>
<td>
<label>A = 685, B = 219, C = 347</label>
</td>
<td>
<input type="radio" name="q2" value="2">
</td>
</tr>
<tr>
<td>
<label>A = 685, B = 347, C = 219</label>
</td>
<td>
<input type="radio" name="q2" value="3">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les quatre principales manières de représenter graphiquement la dispersion d’un semis de points?
</div>
<div>
Relisez au besoin la <a href="#sec-03131">section&nbsp;<span>3.2.3.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Enveloppe convexe</label>
</td>
<td>
<input type="checkbox" name="q3" value="1">
</td>
</tr>
<tr>
<td>
<label>Centre moyen et point central</label>
</td>
<td>
<input type="checkbox" name="q3" value="2">
</td>
</tr>
<tr>
<td>
<label>Rectangle construit avec les déviations standards des X et des Y</label>
</td>
<td>
<input type="checkbox" name="q3" value="3">
</td>
</tr>
<tr>
<td>
<label>Distance standard</label>
</td>
<td>
<input type="checkbox" name="q3" value="4">
</td>
</tr>
<tr>
<td>
<label>Ellipse de déviation de distance standard</label>
</td>
<td>
<input type="checkbox" name="q3" value="5">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les trois principales distributions d’un semis de points?
</div>
<div>
Relisez au besoin la <a href="#sec-033">section&nbsp;<span>3.3</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Distribution dispersée</label>
</td>
<td>
<input type="checkbox" name="q4" value="1">
</td>
</tr>
<tr>
<td>
<label>Distribution aléatoire</label>
</td>
<td>
<input type="checkbox" name="q4" value="2">
</td>
</tr>
<tr>
<td>
<label>Distribution concentrée</label>
</td>
<td>
<input type="checkbox" name="q4" value="3">
</td>
</tr>
<tr>
<td>
<label>Distribution normale</label>
</td>
<td>
<input type="checkbox" name="q4" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
À la lecture des résultats de la méthode du plus proche voisin, quelle année a la distribution spatiale la plus concentrée?
</div>
<img src="images/quiz/Chap03_q05.jpg" alt="" style="width: 50%;display: block;margin-left: auto;margin-right: auto;margin-bottom: 0.5em;margin-top: 0.5em;"><div>
Relisez au besoin la <a href="#sec-0331">section&nbsp;<span>3.3.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>2019</label>
</td>
<td>
<input type="radio" name="q5" value="1">
</td>
</tr>
<tr>
<td>
<label>2020</label>
</td>
<td>
<input type="radio" name="q5" value="2">
</td>
</tr>
<tr>
<td>
<label>2021</label>
</td>
<td>
<input type="radio" name="q5" value="3">
</td>
</tr>
<tr>
<td>
<label>2022</label>
</td>
<td>
<input type="radio" name="q5" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
En analyse des quadrats, quelles sont les trois principales formes utilisées?
</div>
<div>
Relisez au besoin la <a href="#sec-03231">section&nbsp;<span>3.3.2.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Triangle</label>
</td>
<td>
<input type="checkbox" name="q6" value="1">
</td>
</tr>
<tr>
<td>
<label>Carré</label>
</td>
<td>
<input type="checkbox" name="q6" value="2">
</td>
</tr>
<tr>
<td>
<label>Hexagone</label>
</td>
<td>
<input type="checkbox" name="q6" value="3">
</td>
</tr>
<tr>
<td>
<label>Cercle</label>
</td>
<td>
<input type="checkbox" name="q6" value="4">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quel est le paramètre influençant le plus les résultats de la méthode KDE?
</div>
<div>
Relisez au besoin la <a href="#sec-03421">section&nbsp;<span>3.4.2.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>La fonction kernel utilisée</label>
</td>
<td>
<input type="radio" name="q7" value="1">
</td>
</tr>
<tr>
<td>
<label>La taille du rayon d’influence</label>
</td>
<td>
<input type="radio" name="q7" value="2">
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="card quizlib-question">
<div class="quizlib-question-title">
Quelles sont les principales fonctions kernel?
</div>
<div>
Relisez au besoin la <a href="#sec-03421">section&nbsp;<span>3.4.2.1</span></a>.
</div>
<div class="quizlib-question-answers">

<table class="table table-sm table-striped small">
<tbody><tr>
<td>
<label>Gaussienne</label>
</td>
<td>
<input type="checkbox" name="q8" value="1">
</td>
</tr>
<tr>
<td>
<label>Quadratique</label>
</td>
<td>
<input type="checkbox" name="q8" value="2">
</td>
</tr>
<tr>
<td>
<label>Uniforme</label>
</td>
<td>
<input type="checkbox" name="q8" value="3">
</td>
</tr>
<tr>
<td>
<label>Manhattan</label>
</td>
<td>
<input type="checkbox" name="q8" value="4">
</td>
</tr>
<tr>
<td>
<label>Epanechnikov</label>
</td>
<td>
<input type="checkbox" name="q8" value="5">
</td>
</tr>
</tbody></table>
</div>
</div>
<button type="button" onclick="showResults(quizz_Chap03);" id="buttonID">
Vérifier votre résultat
</button>
<div id="quiz-result" class="card">
<p><span id="quiz-percent"></span></p>
</div>
</div>
</section><section id="sec-036" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="sec-036">
<span class="header-section-number">3.6</span> Exercices de révision</h2>
<div class="bloc_exercice">
<div class="bloc_exercice-header">
<div class="bloc_exercice-icon">

</div>
<p><strong>Exercice 1.</strong> Calcul du centre moyen et de la distance standard pour les accidents</p>
</div>
<div class="bloc_exercice-body">
<p>Complétez le code ci-dessous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/chap03/Arrondissements.shp"</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/chap03/IncidentsSecuritePublique.shp"</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Changement de projection</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">3798</span>) </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Incidents, <span class="at">crs =</span> <span class="dv">3798</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Couche pour les accidents</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>Accidents <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, Incidents<span class="sc">$</span>DESCRIPTIO <span class="sc">%in%</span> </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">c</span>(<span class="st">"Accident avec blessés"</span>, <span class="st">"Accident mortel"</span>))</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordonnées et projection cartographique</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> À compléter</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>ProjCarto <span class="ot">&lt;-</span> À compléter</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Centre moyen</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(À compléter)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(CentreMoyen, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>), <span class="at">crs =</span> À compléter)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance standard combinée</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS <span class="ot">&lt;-</span> À compléter</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>CercleDS <span class="ot">&lt;-</span> À compléter</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CercleDS)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correction à la <a href="10-Exercices.html#sec-10031">section&nbsp;<span>9.3.1</span></a>.</p>
</div>
</div>
<div class="bloc_exercice">
<div class="bloc_exercice-header">
<div class="bloc_exercice-icon">

</div>
<p><strong>Exercice 2.</strong> Calcul et cartographie de la densité des accidents dans un maillage irrégulier</p>
</div>
<div class="bloc_exercice-body">
<p>Pour l’année 2021, complétez le code ci-dessous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/chap03/Recen2021Sherbrooke.gpkg"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">layer =</span> <span class="st">"DR_SherbSRDonnees2021"</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Couche pour les accidents pour l'année 2021</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>Acc2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, Incidents<span class="sc">$</span>DESCRIPTIO <span class="sc">%in%</span> </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">c</span>(<span class="st">"Accident avec blessés"</span>, <span class="st">"Accident mortel"</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">&amp;</span> ANNEE<span class="sc">==</span><span class="dv">2021</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Nous nous assurons que les deux couches ont la même projection cartographique</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(SR, <span class="fu">st_crs</span>(Acc2021))</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du nombre d'incidents par SR </span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>SR<span class="sc">$</span>Acc2021 <span class="ot">&lt;-</span> À compléter</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du nombre de méfaits pour 1000 habitants</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>SR<span class="sc">$</span>DensiteMAcc2021Hab <span class="ot">&lt;-</span> À compléter</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(SR)<span class="sc">+</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span> À compléter, <span class="at">style=</span><span class="st">"pretty"</span>, </span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">title=</span><span class="st">"Nombre pour 1000 habitants"</span>,</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">border.col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_bubbles</span>(<span class="at">size =</span> À compléter, <span class="at">border.col =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"aquamarine3"</span>, <span class="at">title.size =</span> <span class="st">"Nombre"</span>, <span class="at">scale =</span> <span class="fl">1.5</span>)<span class="sc">+</span> </span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)<span class="sc">+</span><span class="fu">tm_scale_bar</span>(<span class="at">text.size =</span> .<span class="dv">5</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correction à la <a href="10-Exercices.html#sec-10032">section&nbsp;<span>9.3.2</span></a>.</p>
</div>
</div>
<div class="bloc_exercice">
<div class="bloc_exercice-header">
<div class="bloc_exercice-icon">

</div>
<p><strong>Exercice 3.</strong> Calcul et cartographie de la densité des accidents dans un maillage régulier</p>
</div>
<div class="bloc_exercice-body">
<p>Pour l’année 2021, complétez le code ci-dessous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/chap03/Arrondissements.shp"</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/chap03/IncidentsSecuritePublique.shp"</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Changement de projection</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">3798</span>) </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Incidents, <span class="at">crs =</span> <span class="dv">3798</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Couche pour les méfaits pour l'année 2021</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>M2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, DESCRIPTIO <span class="sc">==</span> <span class="st">"Méfait"</span> <span class="sc">&amp;</span> ANNEE<span class="sc">==</span><span class="dv">2021</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Pour accélérer les calculs, nous retenons uniquement l'arrondissement des Nations</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Couche pour l'arrondissement des Nations</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>ArrDesNations <span class="ot">&lt;-</span> <span class="fu">subset</span>(Arrondissements, NOM <span class="sc">==</span> <span class="st">"Arrondissement des Nations"</span>)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sélection des accidents localisés dans l'arrondissement Des Nations</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>RequeteSpatiale <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(M2021, ArrDesNations, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>M2021<span class="sc">$</span>Nations <span class="ot">&lt;-</span> RequeteSpatiale[, <span class="dv">1</span>]</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>M2021Nations <span class="ot">&lt;-</span> <span class="fu">subset</span>(M2021, M2021<span class="sc">$</span>Nations <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion des données sf dans le format de spatstat</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co"># la fonction as.owin est utilisée pour définir la fenêtre de travail</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>fenetre <span class="ot">&lt;-</span> à complétér</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion des points au format ppp pour les différentes années</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>M2021.ppp <span class="ot">&lt;-</span> à complétér</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Kernel quadratique avec un rayon de 500 mètres et une taille de pixel de 50 mètres</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>kdeQ <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(M2021.ppp, <span class="at">sigma=</span><span class="dv">500</span>, <span class="at">eps=</span><span class="dv">50</span>, <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion en raster</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>RkdeQ <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(kdeQ)<span class="sc">*</span><span class="dv">1000000</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Projection cartographique</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(RkdeQ) <span class="ot">&lt;-</span> <span class="st">"epsg:3857"</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualisation des résultats</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>  À compléter</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correction à la <a href="10-Exercices.html#sec-10033">section&nbsp;<span>9.3.3</span></a>.</p>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-RBoldAir" class="csl-entry" role="listitem">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-baddeley2015spatial" class="csl-entry" role="listitem">
Baddeley, Adrian, Ege Rubak et Rolf Turner. 2015. <em>Spatial point patterns: methodology and applications with R</em>. CRC press.
</div>
<div id="ref-spatstatPackage" class="csl-entry" role="listitem">
Baddeley, Adrian et Rolf Turner. 2005. <span>«&nbsp;<span>spatstat</span>: An <span>R</span> Package for Analyzing Spatial Point Patterns.&nbsp;»</span> <em>Journal of Statistical Software</em> 12 (6): 1‑42. <a href="https://doi.org/10.18637/jss.v012.i06">https://doi.org/10.18637/jss.v012.i06</a>.
</div>
<div id="ref-barbonne2007dynamique" class="csl-entry" role="listitem">
Barbonne, Rémy, Paul Villeneuve et Marius Thériault. 2007. <span>«&nbsp;La dynamique spatiale des march<span>é</span>s locaux de l’emploi au sein du champ m<span>é</span>tropolitain de Qu<span>é</span>bec, 1981–2001.&nbsp;»</span> <em>The Canadian Geographer/Le G<span>é</span>ographe canadien</em> 51 (3). Wiley Online Library: 303‑322. <a href="https://doi.org/10.1111/j.1541-0064.2007.00180.x">https://doi.org/10.1111/j.1541-0064.2007.00180.x</a>.
</div>
<div id="ref-SpatialKDEPackage" class="csl-entry" role="listitem">
Caha, Jan. 2023. <em>SpatialKDE: Kernel Density Estimation for Spatial Data</em>. s.n. <a href="https://CRAN.R-project.org/package=SpatialKDE">https://CRAN.R-project.org/package=SpatialKDE</a>.
</div>
<div id="ref-Packagesparr" class="csl-entry" role="listitem">
Davies, T. M., J. C. Marshall et M. L. Hazelton. 2018. <span>«&nbsp;Tutorial on kernel estimation of continuous spatial and spatiotemporal relative risk.&nbsp;»</span> <em>Statistics in Medicine</em> 37 (7): 1191‑1221.
</div>
<div id="ref-levine2006crime" class="csl-entry" role="listitem">
Levine, Ned. 2006. <span>«&nbsp;Crime mapping and the Crimestat program.&nbsp;»</span> <em>Geographical analysis</em> 38 (1): 41‑56. <a href="https://doi.org/10.1111/j.0016-7363.2005.00673.x">https://doi.org/10.1111/j.0016-7363.2005.00673.x</a>.
</div>
<div id="ref-levine2021crimestat" class="csl-entry" role="listitem">
———. 2021. <span>«&nbsp;CrimeStat IV.&nbsp;»</span> In <em>The Encyclopedia of Research Methods in Criminology and Criminal Justice</em>, sous la dir. de JC Barnes et David R Forde, 1:28‑32. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781119111931.ch6">https://doi.org/10.1002/9781119111931.ch6</a>.
</div>
<div id="ref-lopez2015evolution" class="csl-entry" role="listitem">
López Castro, Marco Antonio, Marius Thériault et Marie-Hélène Vandersmissen. 2015. <span>«&nbsp;<span>É</span>volution de la mobilit<span>é</span> des membres de familles monoparentales dans la r<span>é</span>gion m<span>é</span>tropolitaine de Qu<span>é</span>bec de 1996 <span>à</span> 2006: comparaison entre les m<span>é</span>nages matricentriques et patricentriques.&nbsp;»</span> <em>Cahiers de g<span>é</span>ographie du Qu<span>é</span>bec</em> 59 (167): 209‑250. <a href="https://doi.org/10.7202/1036355ar">https://doi.org/10.7202/1036355ar</a>.
</div>
<div id="ref-mitchel2005esri" class="csl-entry" role="listitem">
Mitchel, Andy. 2005. <em>The ESRI Guide to GIS analysis, Volume 2: Spartial measurements and statistics</em>. ESRI press.
</div>
<div id="ref-tveitesde" class="csl-entry" role="listitem">
Tveite, Håvard. 2020. <span>«&nbsp;The <span>QGIS</span> <span>Standard</span> <span>Deviational</span> <span>Ellipse</span> Plugin.&nbsp;»</span> <a href="http://plugins.qgis.org/plugins/SDEllipse/" class="uri">http://plugins.qgis.org/plugins/SDEllipse/</a>.
</div>
<div id="ref-wang2015confidence" class="csl-entry" role="listitem">
Wang, Bin, Wenzhong Shi et Zelang Miao. 2015. <span>«&nbsp;Confidence analysis of standard deviational ellipse and its extension into higher dimensional Euclidean space.&nbsp;»</span> <em>PloS one</em> 10 (3): e0118537. <a href="https://doi.org/10.1371%2Fjournal.pone.0118537">https://doi.org/10.1371%2Fjournal.pone.0118537</a>.
</div>
<div id="ref-wong1999geostatistics" class="csl-entry" role="listitem">
Wong, David WS. 1999. <span>«&nbsp;Geostatistics as measures of spatial segregation.&nbsp;»</span> <em>Urban geography</em> 20 (7): 635‑647. <a href="https://doi.org/10.2747/0272-3638.20.7.635">https://doi.org/10.2747/0272-3638.20.7.635</a>.
</div>
<div id="ref-wong2005statistical" class="csl-entry" role="listitem">
Wong, David WS et Jay Lee. 2005. <em>Statistical analysis of geographic information with ArcView GIS and ArcGIS</em>. Wiley.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-Autocorrelation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Autocorrélation spatiale</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-AgregatsSpatiaux.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Méthodes de détection d’agrégats spatiaux et spatio-temporels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Méthodes d’analyse spatiale : un grand bol d’R.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Ce livre a été réalisé avec <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>